<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Grammar with Be Heard</title>
    <style>
        :root {
            --primary: #4f46e5;
            --primary-hover: #4338ca;
            --secondary: #ec4899;
            --success: #10b981;
            --error: #ef4444;
            --bg: #f9fafb;
            --card: #ffffff;
            --text-main: #1f2937;
            --text-light: #6b7280;
            --border: #e5e7eb;
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--bg);
            color: var(--text-main);
            margin: 0;
            padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: var(--card);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            color: var(--primary);
            margin-bottom: 30px;
            font-size: 2rem;
        }

        h2 {
            border-left: 5px solid var(--secondary);
            padding-left: 15px;
            margin-top: 40px;
            color: var(--text-main);
        }

        /* Setup Section */
        .section {
            background: #fff;
            padding: 20px;
            border: 1px solid var(--border);
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .grid-checkboxes {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            padding: 10px;
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checkbox-wrapper:hover {
            background-color: #eef2ff;
            border-color: var(--primary);
        }

        .checkbox-wrapper input {
            margin-right: 10px;
            transform: scale(1.2);
        }

        /* Buttons */
        .btn {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: bold;
            border-radius: 8px;
            cursor: pointer;
            width: 100%;
            transition: background 0.3s;
            margin-top: 20px;
        }

        .btn:hover {
            background-color: var(--primary-hover);
        }

        /* Question Blocks */
        .question-card {
            background: white;
            padding: 20px;
            margin-bottom: 25px;
            border-radius: 12px;
            border: 1px solid var(--border);
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        .q-title {
            font-weight: 700;
            font-size: 1.1rem;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
        }

        /* MC Styles */
        .mc-options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }

        .mc-label {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .mc-label:hover {
            background-color: #f3f4f6;
        }

        .mc-label input {
            margin-right: 10px;
        }

        /* Reordering Interactive Styles */
        .reorder-area {
            background-color: #f8fafc;
            border: 2px dashed #cbd5e1;
            border-radius: 8px;
            min-height: 60px;
            padding: 10px;
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 15px;
            align-items: center;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            padding: 10px 0;
        }

        .word-chip {
            background-color: white;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            cursor: pointer;
            user-select: none;
            transition: all 0.2s;
            box-shadow: 0 2px 2px rgba(0,0,0,0.05);
        }

        .word-chip:hover {
            background-color: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .word-chip.in-answer {
            background-color: var(--primary);
            color: white;
        }

        /* Results & Feedback */
        .feedback-box {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            display: none;
            animation: fadeIn 0.5s;
        }

        .feedback-correct {
            background-color: #d1fae5;
            border: 1px solid var(--success);
            color: #064e3b;
        }

        .feedback-wrong {
            background-color: #fee2e2;
            border: 1px solid var(--error);
            color: #7f1d1d;
        }

        .explanation-text {
            font-size: 0.95rem;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid rgba(0,0,0,0.1);
        }

        .score-panel {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 30px;
            border-radius: 12px;
            text-align: center;
            margin-bottom: 30px;
            display: none;
        }

        .hidden { display: none; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 600px) {
            .mc-options { grid-template-columns: 1fr; }
            .container { padding: 15px; }
        }
    </style>
</head>
<body>

<div class="container">
    <h1>üá¨üáß Master English Grammar with Be Heard</h1>

    <div id="setup-view">
        <div class="section">
            <h3>üìÇ Are you ready?</h3>
            <p class="text-light">Ch·ªçn c√°c ƒëi·ªÉm ng·ªØ ph√°p b·∫°n mu·ªën h·ªçc b√™n d∆∞·ªõi nh√©</p>
            <input id="fileInput" accept=".txt,.docx">
            <div id="fileStatus" style="color: var(--success); font-size: 0.9em; margin-top: 5px;"></div>
        </div>

        <div class="section">
            <h3>‚úÖ Select Topics (Max 3)</h3>
            <p style="color: var(--error); display:none;" id="selection-error">Please select between 1 and 3 topics.</p>
            <div class="grid-checkboxes">
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="present_simple"> Present Simple</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="past_simple"> Past Simple</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="future_simple"> Future Simple</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="present_cont"> Present Continuous</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="present_perf"> Present Perfect</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="past_perf"> Past Perfect</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="cond_3"> Conditional Type 3</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="wish"> Wish Sentences</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="passive"> Passive Voice</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="comp_adj"> Comparative Adjectives</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="sup_adj"> Superlative Adjectives</label>
                <label class="checkbox-wrapper"><input type="checkbox" name="grammar" value="possessive"> Possessive Case</label>
            </div>
            <button class="btn" onclick="startTest()">Generate Test</button>
        </div>
    </div>

    <div id="test-view" class="hidden">
        <div id="score-panel" class="score-panel">
            <h2 style="color:white; border:none; margin:0;">Score: <span id="final-score"></span>/20</h2>
            <div id="score-percent" style="font-size: 1.5rem; margin-top: 10px;"></div>
        </div>

        <div id="quiz-content">
            <h2>Part 1: Multiple Choice (10 Questions)</h2>
            <div id="mc-container"></div>

            <h2>Part 2: Sentence Reordering (10 Questions)</h2>
            <p class="text-light">Tap the words in the correct order to build the sentence.</p>
            <div id="order-container"></div>
        </div>

        <button class="btn" id="submit-btn" onclick="submitAnswers()">Submit Answers</button>
        <button class="btn hidden" id="retry-btn" style="background-color: var(--text-main);" onclick="location.reload()">Create New Test</button>
    </div>
</div>

<script>
    // --- DATABASE (Expanded to ensure uniqueness) ---
    const db = [
    // PRESENT SIMPLE - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'present_simple', q: "He ____ his teeth twice a day.", opts: ["brush", "brushes", "brushing", "is brush"], a: "B", exp: "ƒê·ªông t·ª´ t·∫≠n c√πng b·∫±ng 'sh' + ch·ªß ng·ªØ s·ªë √≠t -> th√™m 'es'.", trans: "Anh ·∫•y ƒë√°nh rƒÉng hai l·∫ßn m·ªôt ng√†y." },
    { type: 'mc', tag: 'present_simple', q: "The Earth ____ around the Sun.", opts: ["move", "moves", "moving", "moved"], a: "B", exp: "S·ª± th·∫≠t hi·ªÉn nhi√™n (Facts) -> Hi·ªán t·∫°i ƒë∆°n, ch·ªß ng·ªØ s·ªë √≠t th√™m 's'.", trans: "Tr√°i ƒë·∫•t quay quanh M·∫∑t tr·ªùi." },
    { type: 'mc', tag: 'present_simple', q: "____ your father work in a bank?", opts: ["Do", "Is", "Does", "Are"], a: "C", exp: "C√¢u h·ªèi v·ªõi ƒë·ªông t·ª´ th∆∞·ªùng, ch·ªß ng·ªØ 'your father' (s·ªë √≠t) -> d√πng 'Does'.", trans: "B·ªë b·∫°n c√≥ l√†m vi·ªác ·ªü ng√¢n h√†ng kh√¥ng?" },
    { type: 'mc', tag: 'present_simple', q: "Our classes ____ at 8:00 AM every morning.", opts: ["start", "starts", "starting", "started"], a: "A", exp: "L·ªãch tr√¨nh c·ªë ƒë·ªãnh. Ch·ªß ng·ªØ 'Our classes' (s·ªë nhi·ªÅu) -> gi·ªØ nguy√™n m·∫´u.", trans: "C√°c ti·∫øt h·ªçc c·ªßa ch√∫ng t√¥i b·∫Øt ƒë·∫ßu l√∫c 8 gi·ªù s√°ng m·ªói ng√†y." },
    { type: 'mc', tag: 'present_simple', q: "She ____ to the cinema very often.", opts: ["don't go", "doesn't goes", "doesn't go", "not go"], a: "C", exp: "Ph·ªß ƒë·ªãnh: Does + not + V-nguy√™n m·∫´u (kh√¥ng th√™m s/es v√†o ƒë·ªông t·ª´ ch√≠nh n·ªØa).", trans: "C√¥ ·∫•y kh√¥ng th∆∞·ªùng xuy√™n ƒëi xem phim." },
    { type: 'mc', tag: 'present_simple', q: "A baby ____ when it is hungry.", opts: ["cry", "cries", "crying", "is cry"], a: "B", exp: "ƒê·ªông t·ª´ t·∫≠n c√πng l√† ph·ª• √¢m + 'y' -> ƒë·ªïi 'y' th√†nh 'i' r·ªìi th√™m 'es'.", trans: "Em b√© kh√≥c khi n√≥ th·∫•y ƒë√≥i." },
    { type: 'mc', tag: 'present_simple', q: "I ____ breakfast at home every day.", opts: ["have", "has", "having", "had"], a: "A", exp: "Ch·ªß ng·ªØ 'I' d√πng ƒë·ªông t·ª´ nguy√™n m·∫´u 'have'.", trans: "T√¥i ƒÉn s√°ng t·∫°i nh√† m·ªói ng√†y." },
    { type: 'mc', tag: 'present_simple', q: "Rice ____ in tropical climates.", opts: ["grow", "grows", "growing", "is grow"], a: "B", exp: "S·ª± th·∫≠t hi·ªÉn nhi√™n. 'Rice' l√† danh t·ª´ kh√¥ng ƒë·∫øm ƒë∆∞·ª£c -> d√πng s·ªë √≠t.", trans: "L√∫a g·∫°o m·ªçc ·ªü nh·ªØng v√πng kh√≠ h·∫≠u nhi·ªát ƒë·ªõi." },
    { type: 'mc', tag: 'present_simple', q: "What ____ 'stewardess' mean?", opts: ["do", "is", "does", "are"], a: "C", exp: "C√¢u h·ªèi Wh-. 'stewardess' l√† danh t·ª´ s·ªë √≠t -> d√πng tr·ª£ ƒë·ªông t·ª´ 'does'.", trans: "T·ª´ 'stewardess' c√≥ nghƒ©a l√† g√¨?" },
    { type: 'mc', tag: 'present_simple', q: "They ____ very happy together.", opts: ["be", "is", "are", "am"], a: "C", exp: "ƒê·ªông t·ª´ 'To be' ƒëi v·ªõi ch·ªß ng·ªØ s·ªë nhi·ªÅu 'They' l√† 'are'.", trans: "H·ªç r·∫•t h·∫°nh ph√∫c khi ·ªü b√™n nhau." },
    { type: 'order', tag: 'present_simple', q: "often / how / you / do / exercise / ?", a: "How often do you exercise?", exp: "C·∫•u tr√∫c h·ªèi v·ªÅ t·∫ßn su·∫•t: How often + do/does + S + V?", trans: "B·∫°n c√≥ th∆∞·ªùng xuy√™n t·∫≠p th·ªÉ d·ª•c kh√¥ng?" },
    { type: 'order', tag: 'present_simple', q: "usually / is / for / late / school / he", a: "He is usually late for school.", exp: "Tr·∫°ng t·ª´ t·∫ßn su·∫•t ƒë·ª©ng SAU ƒë·ªông t·ª´ 'to be'.", trans: "C·∫≠u ·∫•y th∆∞·ªùng xuy√™n ƒëi h·ªçc mu·ªôn." },
    { type: 'order', tag: 'present_simple', q: "not / watch / do / they / horror / movies", a: "They do not watch horror movies.", exp: "C·∫•u tr√∫c ph·ªß ƒë·ªãnh v·ªõi ƒë·ªông t·ª´ th∆∞·ªùng.", trans: "H·ªç kh√¥ng xem phim kinh d·ªã." },
    { type: 'order', tag: 'present_simple', q: "on / she / always / time / arrives", a: "She always arrives on time.", exp: "Tr·∫°ng t·ª´ t·∫ßn su·∫•t ƒë·ª©ng TR∆Ø·ªöC ƒë·ªông t·ª´ th∆∞·ªùng.", trans: "C√¥ ·∫•y lu√¥n lu√¥n ƒë·∫øn ƒë√∫ng gi·ªù." },
    { type: 'order', tag: 'present_simple', q: "your / does / live / sister / where / ?", a: "Where does your sister live?", exp: "C√¢u h·ªèi Wh- v·ªõi ng√¥i th·ª© 3 s·ªë √≠t.", trans: "Em g√°i b·∫°n s·ªëng ·ªü ƒë√¢u?" },
    { type: 'order', tag: 'present_simple', q: "Sunday / on / work / doesn't / he", a: "He doesn't work on Sunday.", exp: "S + doesn't + V-inf. 'On + th·ª©' d√πng gi·ªõi t·ª´ 'on'.", trans: "Anh ·∫•y kh√¥ng l√†m vi·ªác v√†o ng√†y Ch·ªß Nh·∫≠t." },
    { type: 'order', tag: 'present_simple', q: "in / we / sometimes / the / park / walk", a: "We sometimes walk in the park.", exp: "V·ªã tr√≠ tr·∫°ng t·ª´ ch·ªâ t·∫ßn su·∫•t 'sometimes'.", trans: "Th·ªânh tho·∫£ng ch√∫ng t√¥i ƒëi d·∫°o trong c√¥ng vi√™n." },
    { type: 'order', tag: 'present_simple', q: "best / drinks / my / friend / never / tea", a: "My best friend never drinks tea.", exp: "D·∫•u hi·ªáu 'never' v√† chia ƒë·ªông t·ª´ 'drinks' theo 'my best friend'.", trans: "B·∫°n th√¢n c·ªßa t√¥i kh√¥ng bao gi·ªù u·ªëng tr√†." },
    { type: 'order', tag: 'present_simple', q: "parents / do / what / your / do / ?", a: "What do your parents do?", exp: "C√¢u h·ªèi v·ªÅ ngh·ªÅ nghi·ªáp: What + do/does + S + do?", trans: "B·ªë m·∫π b·∫°n l√†m ngh·ªÅ g√¨?" },
    { type: 'order', tag: 'present_simple', q: "English / children / simple / learn / songs", a: "Children learn simple English songs.", exp: "T√≠nh t·ª´ 'simple English' ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'songs'.", trans: "Tr·∫ª em h·ªçc nh·ªØng b√†i h√°t ti·∫øng Anh ƒë∆°n gi·∫£n." },
    
    // PAST SIMPLE - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'past_simple', q: "They ____ a new car yesterday.", opts: ["buy", "bought", "buying", "buys"], a: "B", exp: "D·∫•u hi·ªáu 'yesterday' -> Qu√° kh·ª© ƒë∆°n. B·∫•t quy t·∫Øc: buy -> bought.", trans: "H·ªç ƒë√£ mua xe m·ªõi h√¥m qua." },
    { type: 'mc', tag: 'past_simple', q: "I ____ see him at the party last night.", opts: ["didn't", "don't", "wasn't", "not"], a: "A", exp: "Ph·ªß ƒë·ªãnh qu√° kh·ª©: didn't + V-nguy√™n m·∫´u (see).", trans: "T√¥i kh√¥ng th·∫•y anh ·∫•y ·ªü b·ªØa ti·ªác t·ªëi qua." },
    { type: 'mc', tag: 'past_simple', q: "Where ____ you go last summer?", opts: ["do", "did", "were", "are"], a: "B", exp: "C√¢u h·ªèi c√≥ ƒë·ªông t·ª´ th∆∞·ªùng (go) -> d√πng tr·ª£ ƒë·ªông t·ª´ 'did'.", trans: "B·∫°n ƒë√£ ƒëi ƒë√¢u m√πa h√® tr∆∞·ªõc?" },
    { type: 'mc', tag: 'past_simple', q: "She ____ home early last night.", opts: ["come", "came", "comes", "coming"], a: "B", exp: "B·∫•t quy t·∫Øc: come -> came.", trans: "C√¥ ·∫•y v·ªÅ nh√† s·ªõm t·ªëi qua." },
    { type: 'mc', tag: 'past_simple', q: "We ____ to Paris two years ago.", opts: ["travel", "traveled", "travels", "traveling"], a: "B", exp: "D·∫•u hi·ªáu 'ago' -> d√πng V2/ed.", trans: "Ch√∫ng t√¥i ƒë√£ ƒëi du l·ªãch Paris hai nƒÉm tr∆∞·ªõc." },
    { type: 'mc', tag: 'past_simple', q: "____ the weather good yesterday?", opts: ["Did", "Was", "Were", "Is"], a: "B", exp: "C√¢u h·ªèi v·ªõi t√≠nh t·ª´ (good), ch·ªß ng·ªØ s·ªë √≠t -> d√πng 'Was'. Kh√¥ng d√πng 'Did' v√¨ kh√¥ng c√≥ ƒë·ªông t·ª´ th∆∞·ªùng.", trans: "H√¥m qua th·ªùi ti·∫øt c√≥ t·ªët kh√¥ng?" },
    { type: 'mc', tag: 'past_simple', q: "He ____ his phone at the restaurant.", opts: ["forget", "forgets", "forgot", "forgotten"], a: "C", exp: "B·∫•t quy t·∫Øc: forget -> forgot.", trans: "Anh ·∫•y ƒë√£ qu√™n ƒëi·ªán tho·∫°i ·ªü nh√† h√†ng." },
    { type: 'mc', tag: 'past_simple', q: "They ____ married in 2020.", opts: ["get", "got", "gotten", "getting"], a: "B", exp: "S·ª± vi·ªác ƒë√£ k·∫øt th√∫c trong qu√° kh·ª© (2020). B·∫•t quy t·∫Øc: get -> got.", trans: "H·ªç ƒë√£ k·∫øt h√¥n nƒÉm 2020." },
    { type: 'mc', tag: 'past_simple', q: "I ____ a letter to my friend last week.", opts: ["write", "wrote", "written", "writing"], a: "B", exp: "B·∫•t quy t·∫Øc: write -> wrote.", trans: "T√¥i ƒë√£ vi·∫øt th∆∞ cho b·∫°n t√¥i tu·∫ßn tr∆∞·ªõc." },
    { type: 'mc', tag: 'past_simple', q: "The movie ____ at 8 PM and finished at 10 PM.", opts: ["start", "starts", "started", "starting"], a: "C", exp: "H√†nh ƒë·ªông ƒë√£ ho√†n th√†nh trong qu√° kh·ª©.", trans: "B·ªô phim ƒë√£ b·∫Øt ƒë·∫ßu l√∫c 8 gi·ªù v√† k·∫øt th√∫c l√∫c 10 gi·ªù t·ªëi." },
    { type: 'order', tag: 'past_simple', q: "late / was / I / work / for / yesterday", a: "I was late for work yesterday.", exp: "To be ·ªü qu√° kh·ª©: I + was.", trans: "H√¥m qua t√¥i ƒë√£ ƒëi l√†m mu·ªôn." },
    { type: 'order', tag: 'past_simple', q: "did / watch / you / match / the / ?", a: "Did you watch the match?", exp: "C√¢u h·ªèi Yes/No: Did + S + V-inf?", trans: "B·∫°n ƒë√£ xem tr·∫≠n ƒë·∫•u ƒë√≥ ch∆∞a?" },
    { type: 'order', tag: 'past_simple', q: "pizza / ate / we / night / last", a: "We ate pizza last night.", exp: "B·∫•t quy t·∫Øc: eat -> ate.", trans: "Ch√∫ng t√¥i ƒë√£ ƒÉn pizza t·ªëi qua." },
    { type: 'order', tag: 'past_simple', q: "born / was / she / 1990 / in", a: "She was born in 1990.", exp: "C·∫•u tr√∫c 'was born' lu√¥n d√πng ·ªü qu√° kh·ª© ƒë∆°n.", trans: "C√¥ ·∫•y sinh nƒÉm 1990." },
    { type: 'order', tag: 'past_simple', q: "didn't / like / I / movie / the", a: "I didn't like the movie.", exp: "Ph·ªß ƒë·ªãnh: S + didn't + V-inf.", trans: "T√¥i kh√¥ng th√≠ch b·ªô phim ƒë√≥." },
    { type: 'order', tag: 'past_simple', q: "when / arrive / you / did / ?", a: "When did you arrive?", exp: "C√¢u h·ªèi Wh-: Wh-word + did + S + V-inf?", trans: "B·∫°n ƒë√£ ƒë·∫øn khi n√†o?" },
    { type: 'order', tag: 'past_simple', q: "home / walked / they / school / from", a: "They walked home from school.", exp: "H√†nh ƒë·ªông ƒë√£ x·∫£y ra v√† k·∫øt th√∫c.", trans: "H·ªç ƒë√£ ƒëi b·ªô v·ªÅ nh√† t·ª´ tr∆∞·ªùng." },
    { type: 'order', tag: 'past_simple', q: "it / rained / heavily / yesterday", a: "It rained heavily yesterday.", exp: "D·∫•u hi·ªáu 'yesterday'.", trans: "H√¥m qua tr·ªùi m∆∞a r·∫•t to." },
    { type: 'order', tag: 'past_simple', q: "finished / work / he / at / 5", a: "He finished work at 5.", exp: "Th√™m 'ed' cho ƒë·ªông t·ª´ c√≥ quy t·∫Øc.", trans: "Anh ·∫•y ƒë√£ xong vi·ªác l√∫c 5 gi·ªù." },
    { type: 'order', tag: 'past_simple', q: "did / why / leave / early / she / ?", a: "Why did she leave early?", exp: "Wh-word + did + S + V-inf?", trans: "T·∫°i sao c√¥ ·∫•y l·∫°i r·ªùi ƒëi s·ªõm?" },
    
    // FUTURE SIMPLE - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'future_forms', q: "I think it ____ rain tomorrow.", opts: ["will", "is going to", "is", "shall"], a: "A", exp: "D·ª± ƒëo√°n d·ª±a tr√™n quan ƒëi·ªÉm c√° nh√¢n (I think) -> D√πng 'Will'.", trans: "T√¥i nghƒ© ng√†y mai tr·ªùi s·∫Ω m∆∞a." },
    { type: 'mc', tag: 'future_forms', q: "Look at the clouds! It ____ rain.", opts: ["will", "is going to", "wills", "going to"], a: "B", exp: "D·ª± ƒëo√°n c√≥ b·∫±ng ch·ª©ng c·ª• th·ªÉ ·ªü hi·ªán t·∫°i (clouds) -> D√πng 'Be going to'.", trans: "Nh√¨n m√¢y k√¨a! Tr·ªùi s·∫Øp m∆∞a r·ªìi." },
    { type: 'mc', tag: 'future_forms', q: "I promise I ____ help you.", opts: ["am going to", "will", "am", "do"], a: "B", exp: "L·ªùi h·ª©a (Promise) -> D√πng 'Will'.", trans: "T√¥i h·ª©a t√¥i s·∫Ω gi√∫p b·∫°n." },
    { type: 'mc', tag: 'future_forms', q: "They ____ arrive at 8 PM.", opts: ["will", "is going to", "go to", "shall"], a: "A", exp: "Di·ªÖn t·∫£ m·ªôt s·ª± ki·ªán s·∫Ω x·∫£y ra trong t∆∞∆°ng lai (Future fact).", trans: "H·ªç s·∫Ω ƒë·∫øn l√∫c 8 gi·ªù t·ªëi." },
    { type: 'mc', tag: 'future_forms', q: "I have to go now. I ____ call you later.", opts: ["am", "will", "am going", "going to"], a: "B", exp: "Quy·∫øt ƒë·ªãnh ƒë∆∞a ra ngay l√∫c n√≥i (Spontaneous decision) -> D√πng 'Will'.", trans: "T√¥i ph·∫£i ƒëi r·ªìi. T√¥i s·∫Ω g·ªçi l·∫°i cho b·∫°n sau." },
    { type: 'mc', tag: 'future_forms', q: "We ____ have a meeting tomorrow morning.", opts: ["are going to", "wills", "go to", "shall"], a: "A", exp: "K·∫ø ho·∫°ch/D·ª± ƒë·ªãnh ƒë√£ c√≥ t·ª´ tr∆∞·ªõc (Plan) -> D√πng 'Be going to'.", trans: "Ch√∫ng t√¥i ƒë·ªãnh s·∫Ω c√≥ cu·ªôc h·ªçp v√†o s√°ng mai." },
    { type: 'mc', tag: 'future_forms', q: "She ____ study abroad next year.", opts: ["is", "is going to", "goes to", "shall"], a: "B", exp: "K·∫ø ho·∫°ch ch·∫Øc ch·∫Øn trong t∆∞∆°ng lai -> D√πng 'Be going to'.", trans: "C√¥ ·∫•y d·ª± ƒë·ªãnh ƒëi du h·ªçc v√†o nƒÉm sau." },
    { type: 'mc', tag: 'future_forms', q: "____ you help me with this box?", opts: ["Will", "Are", "Do", "Shall"], a: "A", exp: "C√¢u y√™u c·∫ßu/ƒë·ªÅ ngh·ªã (Request) -> D√πng 'Will'.", trans: "B·∫°n gi√∫p t√¥i b√™ c√°i h·ªôp n√†y ƒë∆∞·ª£c kh√¥ng?" },
    { type: 'mc', tag: 'future_forms', q: "Don't worry, I ____ be there on time.", opts: ["am", "will", "am going", "going to"], a: "B", exp: "L·ªùi h·ª©a/S·ª± ƒë·∫£m b·∫£o (Assurance) -> D√πng 'Will'.", trans: "ƒê·ª´ng lo, t√¥i s·∫Ω c√≥ m·∫∑t ƒë√∫ng gi·ªù." },
    { type: 'mc', tag: 'future_forms', q: "I think they ____ not come to the party.", opts: ["will", "are", "do", "is"], a: "A", exp: "Ph·ªß ƒë·ªãnh c·ªßa t∆∞∆°ng lai ƒë∆°n: Will not (Won't).", trans: "T√¥i nghƒ© h·ªç s·∫Ω kh√¥ng ƒë·∫øn b·ªØa ti·ªác ƒë√¢u." },
    { type: 'order', tag: 'future_forms', q: "travel / will / to / Japan / next / I / year", a: "I will travel to Japan next year.", exp: "C·∫•u tr√∫c t∆∞∆°ng lai ƒë∆°n: S + will + V.", trans: "T√¥i s·∫Ω ƒëi Nh·∫≠t v√†o nƒÉm sau." },
    { type: 'order', tag: 'future_forms', q: "are / visit / going / to / we / our mom", a: "We are going to visit our mom.", exp: "D·ª± ƒë·ªãnh: S + be going to + V.", trans: "Ch√∫ng t√¥i ƒë·ªãnh ƒëi thƒÉm m·∫π." },
    { type: 'order', tag: 'future_forms', q: "call / you / I / back / later / will", a: "I will call you back later.", exp: "Quy·∫øt ƒë·ªãnh t·ª©c th√¨: Will.", trans: "T√¥i s·∫Ω g·ªçi l·∫°i cho b·∫°n sau." },
    { type: 'order', tag: 'future_forms', q: "going / is / to / she / doctor / the / see", a: "She is going to see the doctor.", exp: "K·∫ø ho·∫°ch ƒëi kh√°m b·ªánh -> D√πng Be going to.", trans: "C√¥ ·∫•y ƒë·ªãnh ƒëi g·∫∑p b√°c sƒ©." },
    { type: 'order', tag: 'future_forms', q: "will / tomorrow / what / you / do / ?", a: "What will you do tomorrow?", exp: "C√¢u h·ªèi Wh- v·ªõi Will.", trans: "Ng√†y mai b·∫°n s·∫Ω l√†m g√¨?" },
    { type: 'order', tag: 'future_forms', q: "not / I / going / am / to / that / eat", a: "I am not going to eat that.", exp: "Ph·ªß ƒë·ªãnh c·ªßa t∆∞∆°ng lai g·∫ßn: Be + not + going to.", trans: "T√¥i kh√¥ng ƒë·ªãnh ƒÉn c√°i ƒë√≥ ƒë√¢u." },
    { type: 'order', tag: 'future_forms', q: "rain / it / will / tonight / ?", a: "Will it rain tonight?", exp: "C√¢u h·ªèi Yes/No v·ªÅ d·ª± ƒëo√°n.", trans: "Li·ªáu t·ªëi nay tr·ªùi c√≥ m∆∞a kh√¥ng?" },
    { type: 'order', tag: 'future_forms', q: "probably / will / he / late / be", a: "He will probably be late.", exp: "V·ªã tr√≠ tr·∫°ng t·ª´: Will + probably + V.", trans: "Anh ·∫•y c√≥ l·∫Ω s·∫Ω ƒë·∫øn mu·ªôn." },
    { type: 'order', tag: 'future_forms', q: "are / to / we / movie / a / going / watch", a: "We are going to watch a movie.", exp: "K·∫ø ho·∫°ch gi·∫£i tr√≠ -> Be going to.", trans: "Ch√∫ng t√¥i ƒë·ªãnh ƒëi xem phim." },
    { type: 'order', tag: 'future_forms', q: "will / when / arrive / guests / our / ?", a: "When will our guests arrive?", exp: "C√¢u h·ªèi v·ªÅ th·ªùi gian trong t∆∞∆°ng lai.", trans: "Khi n√†o kh√°ch c·ªßa ch√∫ng ta s·∫Ω ƒë·∫øn?" },
    
    // PRESENT CONTINUOUS - 10 MC, 10 Order (ƒê√É KI·ªÇM TRA - OK)
    { type: 'mc', tag: 'present_cont', q: "Listen! Someone ____ the piano.", opts: ["play", "plays", "is playing", "played"], a: "C", exp: "D·∫•u hi·ªáu m·ªánh l·ªánh 'Listen!' -> H√†nh ƒë·ªông ƒëang x·∫£y ra ngay l√∫c n√≥i.", trans: "Nghe k√¨a! C√≥ ai ƒë√≥ ƒëang ch∆°i ƒë√†n piano." },
    { type: 'mc', tag: 'present_cont', q: "We ____ dinner at the moment.", opts: ["have", "are having", "had", "having"], a: "B", exp: "'At the moment' -> Hi·ªán t·∫°i ti·∫øp di·ªÖn. 'Have' ·ªü ƒë√¢y nghƒ©a l√† 'ƒÉn' n√™n ƒë∆∞·ª£c chia V-ing.", trans: "Ch√∫ng t√¥i ƒëang d√πng b·ªØa t·ªëi ngay l√∫c n√†y." },
    { type: 'mc', tag: 'present_cont', q: "He ____ working today, he is sick.", opts: ["isn't", "doesn't", "not", "aren't"], a: "A", exp: "H√†nh ƒë·ªông mang t√≠nh t·∫°m th·ªùi (h√¥m nay ngh·ªâ). Ph·ªß ƒë·ªãnh v·ªõi 'is' -> isn't.", trans: "H√¥m nay anh ·∫•y kh√¥ng ƒëi l√†m, anh ·∫•y b·ªã ·ªëm." },
    { type: 'mc', tag: 'present_cont', q: "____ you waiting for someone?", opts: ["Do", "Are", "Is", "Does"], a: "B", exp: "C√¢u h·ªèi Yes/No: Are + S + V-ing?", trans: "B·∫°n ƒëang ƒë·ª£i ai ƒë√≥ ph·∫£i kh√¥ng?" },
    { type: 'mc', tag: 'present_cont', q: "She ____ a book right now.", opts: ["read", "reads", "is reading", "reading"], a: "C", exp: "D·∫•u hi·ªáu 'Right now' -> ƒêang x·∫£y ra.", trans: "C√¥ ·∫•y ƒëang ƒë·ªçc s√°ch ngay b√¢y gi·ªù." },
    { type: 'mc', tag: 'present_cont', q: "They ____ to London tomorrow.", opts: ["travel", "are traveling", "travels", "traveling"], a: "B", exp: "K·∫ø ho·∫°ch t∆∞∆°ng lai ƒë√£ ƒë∆∞·ª£c s·∫Øp x·∫øp (Future arrangement) -> D√πng HTTD.", trans: "H·ªç s·∫Ω ƒëi London v√†o ng√†y mai (ƒë√£ l√™n l·ªãch)." },
    { type: 'mc', tag: 'present_cont', q: "I ____ my homework now.", opts: ["do", "doing", "am doing", "does"], a: "C", exp: "Ch·ªß ng·ªØ 'I' ƒëi v·ªõi 'am' + doing.", trans: "B√¢y gi·ªù t√¥i ƒëang l√†m b√†i t·∫≠p." },
    { type: 'mc', tag: 'present_cont', q: "What ____ you doing?", opts: ["are", "is", "do", "does"], a: "A", exp: "C√¢u h·ªèi Wh-: Wh + be + S + V-ing?", trans: "B·∫°n ƒëang l√†m c√°i g√¨ th·∫ø?" },
    { type: 'mc', tag: 'present_cont', q: "He ____ not coming to the party.", opts: ["is", "are", "am", "does"], a: "A", exp: "Ch·ªß ng·ªØ 'He' (s·ªë √≠t) -> d√πng tr·ª£ ƒë·ªông t·ª´ 'is'.", trans: "Anh ·∫•y s·∫Ω kh√¥ng ƒë·∫øn b·ªØa ti·ªác ƒë√¢u." },
    { type: 'mc', tag: 'present_cont', q: "The kids ____ in the garden.", opts: ["play", "plays", "are playing", "played"], a: "C", exp: "H√†nh ƒë·ªông ƒëang di·ªÖn ra. 'The kids' l√† s·ªë nhi·ªÅu -> are playing.", trans: "B·ªçn tr·∫ª ƒëang ch∆°i ngo√†i v∆∞·ªùn." },
    { type: 'order', tag: 'present_cont', q: "is / she / book / reading / a / now", a: "She is reading a book now.", exp: "C·∫•u tr√∫c kh·∫≥ng ƒë·ªãnh: S + be + V-ing.", trans: "C√¥ ·∫•y ƒëang ƒë·ªçc m·ªôt cu·ªën s√°ch." },
    { type: 'order', tag: 'present_cont', q: "why / crying / are / you / ?", a: "Why are you crying?", exp: "C√¢u h·ªèi Wh-: T·∫°i sao b·∫°n ƒëang kh√≥c?", trans: "T·∫°i sao b·∫°n l·∫°i kh√≥c?" },
    { type: 'order', tag: 'present_cont', q: "sleeping / baby / the / is / Shh!", a: "Shh! The baby is sleeping.", exp: "C√¢u m·ªánh l·ªánh c·∫£nh b√°o + h√†nh ƒë·ªông ƒëang x·∫£y ra.", trans: "Su·ªµt! Em b√© ƒëang ng·ªß." },
    { type: 'order', tag: 'present_cont', q: "am / I / TV / watching / not", a: "I am not watching TV.", exp: "C√¢u ph·ªß ƒë·ªãnh: I + am not + V-ing.", trans: "T√¥i ƒëang kh√¥ng xem TV." },
    { type: 'order', tag: 'present_cont', q: "are / what / doing / you / tonight / ?", a: "What are you doing tonight?", exp: "H·ªèi v·ªÅ k·∫ø ho·∫°ch t·ªëi nay.", trans: "T·ªëi nay b·∫°n ƒë·ªãnh l√†m g√¨?" },
    { type: 'order', tag: 'present_cont', q: "cooking / dinner / mom / is / my", a: "My mom is cooking dinner.", exp: "H√†nh ƒë·ªông ƒëang x·∫£y ra t·∫°i th·ªùi ƒëi·ªÉm n√≥i.", trans: "M·∫π t√¥i ƒëang n·∫•u b·ªØa t·ªëi." },
    { type: 'order', tag: 'present_cont', q: "they / are / where / going / ?", a: "Where are they going?", exp: "C√¢u h·ªèi v·ªÅ h∆∞·ªõng di chuy·ªÉn hi·ªán t·∫°i.", trans: "H·ªç ƒëang ƒëi ƒë√¢u v·∫≠y?" },
    { type: 'order', tag: 'present_cont', q: "getting / is / dark / it", a: "It is getting dark.", exp: "Di·ªÖn t·∫£ s·ª± thay ƒë·ªïi d·∫ßn d·∫ßn (Process of change).", trans: "Tr·ªùi ƒëang t·ªëi d·∫ßn." },
    { type: 'order', tag: 'present_cont', q: "not / working / computer / my / is", a: "My computer is not working.", exp: "Di·ªÖn t·∫£ t√¨nh tr·∫°ng h·ªèng h√≥c/kh√¥ng ho·∫°t ƒë·ªông t·∫°m th·ªùi.", trans: "M√°y t√≠nh c·ªßa t√¥i ƒëang kh√¥ng ch·∫°y." },
    { type: 'order', tag: 'present_cont', q: "waiting / who / for / you / are / ?", a: "Who are you waiting for?", exp: "Gi·ªõi t·ª´ 'for' ƒë·∫∑t cu·ªëi c√¢u trong c√¢u h·ªèi Wh-.", trans: "B·∫°n ƒëang ƒë·ª£i ai th·∫ø?" },
    
    // PRESENT PERFECT - 10 MC, 10 Order (ƒê√É KI·ªÇM TRA - OK)
    { type: 'mc', tag: 'present_perf', q: "I can't find my wallet. I ____ lost it.", opts: ["have", "has", "had", "did"], a: "A", exp: "H√†nh ƒë·ªông x·∫£y ra trong qu√° kh·ª© nh∆∞ng ƒë·ªÉ l·∫°i h·∫≠u qu·∫£ ·ªü hi·ªán t·∫°i (ch∆∞a t√¨m th·∫•y).", trans: "T√¥i kh√¥ng t√¨m th·∫•y v√≠. T√¥i ƒë√£ l√†m m·∫•t n√≥ r·ªìi." },
    { type: 'mc', tag: 'present_perf', q: "She ____ visited London twice.", opts: ["have", "has", "is", "did"], a: "B", exp: "N√≥i v·ªÅ tr·∫£i nghi·ªám trong ƒë·ªùi (Life experience) -> Has + V3.", trans: "C√¥ ·∫•y ƒë√£ ƒë·∫øn thƒÉm London 2 l·∫ßn." },
    { type: 'mc', tag: 'present_perf', q: "We haven't ____ the movie yet.", opts: ["see", "saw", "seen", "seeing"], a: "C", exp: "Sau Have/Has ph·∫£i l√† ƒë·ªông t·ª´ ·ªü c·ªôt 3 (V3/Past Participle).", trans: "Ch√∫ng t√¥i v·∫´n ch∆∞a xem b·ªô phim ƒë√≥." },
    { type: 'mc', tag: 'present_perf', q: "____ you ever been to Japan?", opts: ["Have", "Has", "Did", "Do"], a: "A", exp: "C√¢u h·ªèi v·ªÅ tr·∫£i nghi·ªám: Have + S + ever + V3?", trans: "B·∫°n ƒë√£ t·ª´ng ƒë·∫øn Nh·∫≠t B·∫£n bao gi·ªù ch∆∞a?" },
    { type: 'mc', tag: 'present_perf', q: "They ____ just arrived at the airport.", opts: ["have", "has", "had", "are"], a: "A", exp: "'Just' (v·ª´a m·ªõi) ch·ªâ h√†nh ƒë·ªông v·ª´a x·∫£y ra -> Have/Has + just + V3.", trans: "H·ªç v·ª´a m·ªõi ƒë·∫øn s√¢n bay." },
    { type: 'mc', tag: 'present_perf', q: "He ____ lived here since 2010.", opts: ["have", "has", "had", "is"], a: "B", exp: "'Since' + m·ªëc th·ªùi gian (2010). Ch·ªß ng·ªØ 'He' d√πng 'Has'.", trans: "Anh ·∫•y ƒë√£ s·ªëng ·ªü ƒë√¢y t·ª´ nƒÉm 2010." },
    { type: 'mc', tag: 'present_perf', q: "I ____ finished my homework, can I go out?", opts: ["have", "has", "am", "did"], a: "A", exp: "H√†nh ƒë·ªông ƒë√£ ho√†n th√†nh v√† quan tr·ªçng l√† k·∫øt qu·∫£ hi·ªán t·∫°i (xong r·ªìi).", trans: "Con ƒë√£ l√†m xong b√†i t·∫≠p, con ƒëi ch∆°i ƒë∆∞·ª£c kh√¥ng?" },
    { type: 'mc', tag: 'present_perf', q: "____ she eaten lunch yet?", opts: ["Has", "Have", "Did", "Does"], a: "A", exp: "C√¢u h·ªèi v·ªõi 'Yet' ·ªü cu·ªëi c√¢u -> Th√¨ hi·ªán t·∫°i ho√†n th√†nh.", trans: "C√¥ ·∫•y ƒë√£ ƒÉn tr∆∞a ch∆∞a?" },
    { type: 'mc', tag: 'present_perf', q: "We ____ never seen that movie.", opts: ["have", "has", "had", "did"], a: "A", exp: "D·∫•u hi·ªáu 'Never'. V·ªã tr√≠: Have + never + V3.", trans: "Ch√∫ng t√¥i ch∆∞a bao gi·ªù xem b·ªô phim ƒë√≥." },
    { type: 'mc', tag: 'present_perf', q: "How long ____ you known her?", opts: ["have", "has", "did", "do"], a: "A", exp: "C√¢u h·ªèi 'How long' (Bao l√¢u) th∆∞·ªùng ƒëi v·ªõi th√¨ HTHT v·ªõi ƒë·ªông t·ª´ tri gi√°c (know).", trans: "B·∫°n bi·∫øt c√¥ ·∫•y ƒë∆∞·ª£c bao l√¢u r·ªìi?" },
    { type: 'order', tag: 'present_perf', q: "lived / have / I / here / years / for / two", a: "I have lived here for two years.", exp: "For + period of time.", trans: "T√¥i ƒë√£ s·ªëng ·ªü ƒë√¢y 2 nƒÉm." },
    { type: 'order', tag: 'present_perf', q: "just / has / he / finished / work", a: "He has just finished work.", exp: "'Just' comes between has and V3.", trans: "Anh ·∫•y v·ª´a m·ªõi xong vi·ªác." },
    { type: 'order', tag: 'present_perf', q: "you / ever / eaten / sushi / have / ?", a: "Have you ever eaten sushi?", exp: "Experience question: Have + S + ever + V3?", trans: "B·∫°n ƒë√£ bao gi·ªù ƒÉn sushi ch∆∞a?" },
    { type: 'order', tag: 'present_perf', q: "has / she / not / yet / arrived", a: "She has not arrived yet.", exp: "'Yet' in negative present perfect.", trans: "C√¥ ·∫•y v·∫´n ch∆∞a ƒë·∫øn." },
    { type: 'order', tag: 'present_perf', q: "since / known / I / have / him / 2015", a: "I have known him since 2015.", exp: "'Since' with specific point in time.", trans: "T√¥i bi·∫øt anh ·∫•y t·ª´ nƒÉm 2015." },
    { type: 'order', tag: 'present_perf', q: "been / have / where / you / ?", a: "Where have you been?", exp: "Question about recent whereabouts.", trans: "B·∫°n ƒë√£ ·ªü ƒë√¢u?" },
    { type: 'order', tag: 'present_perf', q: "already / seen / have / movie / I / that", a: "I have already seen that movie.", exp: "'Already' comes between have and V3.", trans: "T√¥i ƒë√£ xem b·ªô phim ƒë√≥ r·ªìi." },
    { type: 'order', tag: 'present_perf', q: "how / books / many / read / you / have / ?", a: "How many books have you read?", exp: "Question about quantity with present perfect.", trans: "B·∫°n ƒë√£ ƒë·ªçc bao nhi√™u quy·ªÉn s√°ch?" },
    { type: 'order', tag: 'present_perf', q: "never / traveled / have / I / plane / by", a: "I have never traveled by plane.", exp: "'Never' with present perfect.", trans: "T√¥i ch∆∞a bao gi·ªù ƒëi du l·ªãch b·∫±ng m√°y bay." },
    { type: 'order', tag: 'present_perf', q: "already / saved / have / money / we / enough", a: "We have already saved enough money.", exp: "'already' d√πng cho h√†nh ƒë·ªông ƒë√£ l√†m r·ªìi, th∆∞·ªùng ƒë·ª©ng sau 'have'.", trans: "Ch√∫ng t√¥i ƒë√£ ti·∫øt ki·ªám ƒë·ªß ti·ªÅn r·ªìi." },
    
    // PAST PERFECT - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'past_perf', q: "When I arrived at the station, the train ____ already left.", opts: ["has", "have", "had", "was"], a: "C", exp: "H√†nh ƒë·ªông t√†u ƒëi x·∫£y ra TR∆Ø·ªöC h√†nh ƒë·ªông 'ƒë·∫øn' (qu√° kh·ª© c·ªßa qu√° kh·ª©) -> Had + V3.", trans: "Khi t√¥i ƒë·∫øn ga, t√†u ƒë√£ ƒëi m·∫•t r·ªìi." },
    { type: 'mc', tag: 'past_perf', q: "She was hungry because she ____ eaten anything all day.", opts: ["hasn't", "hadn't", "didn't", "wouldn't"], a: "B", exp: "Nguy√™n nh√¢n (ch∆∞a ƒÉn) x·∫£y ra tr∆∞·ªõc k·∫øt qu·∫£ trong qu√° kh·ª© (th·∫•y ƒë√≥i).", trans: "C√¥ ·∫•y ƒë√≥i v√¨ tr∆∞·ªõc ƒë√≥ c√¥ ·∫•y ch∆∞a ƒÉn g√¨ c·∫£." },
    { type: 'mc', tag: 'past_perf', q: "They ____ finished the project before the deadline yesterday.", opts: ["have", "has", "had", "were"], a: "C", exp: "Ho√†n th√†nh tr∆∞·ªõc m·ªôt m·ªëc th·ªùi gian c·ª• th·ªÉ trong qu√° kh·ª©.", trans: "H·ªç ƒë√£ ho√†n th√†nh d·ª± √°n tr∆∞·ªõc h·∫°n ch√≥t ng√†y h√¥m qua." },
    { type: 'mc', tag: 'past_perf', q: "I ____ never seen such a beautiful sunset before that trip.", opts: ["have", "has", "had", "did"], a: "C", exp: "Tr·∫£i nghi·ªám t√≠nh ƒë·∫øn m·ªôt th·ªùi ƒëi·ªÉm trong qu√° kh·ª© -> D√πng Had + never + V3.", trans: "Tr∆∞·ªõc chuy·∫øn ƒëi ƒë√≥, t√¥i ch∆∞a t·ª´ng th·∫•y ho√†ng h√¥n n√†o ƒë·∫πp nh∆∞ v·∫≠y." },
    { type: 'mc', tag: 'past_perf', q: "____ you visited Paris before you moved to France?", opts: ["Have", "Had", "Did", "Were"], a: "B", exp: "H·ªèi v·ªÅ m·ªôt h√†nh ƒë·ªông x·∫£y ra tr∆∞·ªõc m·ªôt h√†nh ƒë·ªông qu√° kh·ª© kh√°c (moved).", trans: "B·∫°n ƒë√£ t·ª´ng thƒÉm Paris tr∆∞·ªõc khi b·∫°n chuy·ªÉn sang Ph√°p s·ªëng ch∆∞a?" },
    { type: 'mc', tag: 'past_perf', q: "He suddenly realized he ____ his wallet at home.", opts: ["forget", "forgot", "had forgotten", "has forgotten"], a: "C", exp: "Vi·ªác 'qu√™n' x·∫£y ra tr∆∞·ªõc vi·ªác 'nh·∫≠n ra'.", trans: "Anh ·∫•y ƒë·ªôt nhi√™n nh·∫≠n ra m√¨nh ƒë√£ qu√™n v√≠ ·ªü nh√†." },
    { type: 'mc', tag: 'past_perf', q: "After they ____ dinner, they went out for a walk.", opts: ["had", "have", "had had", "have had"], a: "C", exp: "C·∫•u tr√∫c: After + S + Had + V3. ·ªû ƒë√¢y V3 c·ªßa 'have' (ƒÉn) ch√≠nh l√† 'had'.", trans: "Sau khi h·ªç ƒÉn t·ªëi xong, h·ªç ƒë√£ ƒëi d·∫°o." },
    { type: 'mc', tag: 'past_perf', q: "She ____ already left the office when I called her.", opts: ["has", "have", "had", "was"], a: "C", exp: "H√†nh ƒë·ªông 'r·ªùi ƒëi' ho√†n th√†nh tr∆∞·ªõc h√†nh ƒë·ªông 'g·ªçi'.", trans: "C√¥ ·∫•y ƒë√£ r·ªùi vƒÉn ph√≤ng r·ªìi khi t√¥i g·ªçi cho c√¥ ·∫•y." },
    { type: 'mc', tag: 'past_perf', q: "We ____ never met before that fateful day.", opts: ["have", "has", "had", "did"], a: "C", exp: "D√πng Had + never + V3 ƒë·ªÉ n√≥i v·ªÅ vi·ªác ch∆∞a t·ª´ng l√†m tr∆∞·ªõc m·ªôt m·ªëc qu√° kh·ª©.", trans: "Ch√∫ng t√¥i ch∆∞a t·ª´ng g·∫∑p nhau tr∆∞·ªõc ng√†y ƒë·ªãnh m·ªánh ƒë√≥." },
    { type: 'mc', tag: 'past_perf', q: "By the time we arrived at the cinema, the show ____.", opts: ["start", "started", "had started", "has started"], a: "C", exp: "C·∫•u tr√∫c 'By the time + QKƒê, S + QKHT'.", trans: "V√†o l√∫c ch√∫ng t√¥i ƒë·∫øn r·∫°p, bu·ªïi di·ªÖn ƒë√£ b·∫Øt ƒë·∫ßu r·ªìi." },
    { type: 'order', tag: 'past_perf', q: "had / finished / We / dinner / he / before / arrived", a: "We had finished dinner before he arrived.", exp: "H√†nh ƒë·ªông ƒÉn xong x·∫£y ra tr∆∞·ªõc khi anh ·∫•y ƒë·∫øn.", trans: "Ch√∫ng t√¥i ƒë√£ ƒÉn xong tr∆∞·ªõc khi anh ·∫•y ƒë·∫øn." },
    { type: 'order', tag: 'past_perf', q: "never / she / been / had / abroad / before", a: "She had never been abroad before.", exp: "V·ªã tr√≠ tr·∫°ng t·ª´: Had + never + V3.", trans: "Tr∆∞·ªõc ƒë√≥ c√¥ ·∫•y ch∆∞a bao gi·ªù ra n∆∞·ªõc ngo√†i." },
    { type: 'order', tag: 'past_perf', q: "had / left / They / already / when / came / I", a: "They had already left when I came.", exp: "Already ƒë·ª©ng gi·ªØa Had v√† V3.", trans: "H·ªç ƒë√£ r·ªùi ƒëi khi t√¥i ƒë·∫øn." },
    { type: 'order', tag: 'past_perf', q: "left / I / had / keys / my / home / at", a: "I had left my keys at home.", exp: "C·∫•u tr√∫c kh·∫≥ng ƒë·ªãnh th√¨ Qu√° kh·ª© ho√†n th√†nh.", trans: "T√¥i ƒë√£ ƒë·ªÉ qu√™n ch√¨a kh√≥a ·ªü nh√†." },
    { type: 'order', tag: 'past_perf', q: "had / she / studied / before / the / test", a: "She had studied before the test.", exp: "Ho√†n th√†nh vi·ªác h·ªçc tr∆∞·ªõc khi k·ª≥ thi di·ªÖn ra.", trans: "C√¥ ·∫•y ƒë√£ √¥n t·∫≠p tr∆∞·ªõc khi b√†i ki·ªÉm tra b·∫Øt ƒë·∫ßu." },
    { type: 'order', tag: 'past_perf', q: "had / he / never / flown / before / that", a: "He had never flown before that.", exp: "K·ªÉ v·ªÅ m·ªôt tr·∫£i nghi·ªám ƒë·∫ßu ti√™n trong qu√° kh·ª©.", trans: "Tr∆∞·ªõc ƒë√≥ anh ·∫•y ch∆∞a bao gi·ªù ƒëi m√°y bay." },
    { type: 'order', tag: 'past_perf', q: "lost / had / weight / he / before / wedding / the", a: "He had lost weight before the wedding.", exp: "H√†nh ƒë·ªông ho√†n th√†nh tr∆∞·ªõc m·ªôt s·ª± ki·ªán qu√° kh·ª©.", trans: "Anh ·∫•y ƒë√£ gi·∫£m c√¢n tr∆∞·ªõc khi ƒë√°m c∆∞·ªõi di·ªÖn ra." },
    { type: 'order', tag: 'past_perf', q: "finished / work / had / I / by / 6", a: "I had finished work by 6.", exp: "By + m·ªëc th·ªùi gian qu√° kh·ª© -> d√πng QKHT.", trans: "T√¥i ƒë√£ xong vi·ªác v√†o l√∫c 6 gi·ªù." },
    { type: 'order', tag: 'past_perf', q: "met / had / they / before / never / that", a: "They had never met before that.", exp: "Ph·ªß ƒë·ªãnh tr·∫£i nghi·ªám trong qu√° kh·ª©.", trans: "Tr∆∞·ªõc ƒë√≥ h·ªç ch∆∞a t·ª´ng g·∫∑p nhau." },
    { type: 'order', tag: 'past_perf', q: "had / seen / movie / I / that / already", a: "I had already seen that movie.", exp: "S + had + already + V3.", trans: "T√¥i ƒë√£ xem b·ªô phim ƒë√≥ tr∆∞·ªõc l√∫c ·∫•y r·ªìi." },
    
    // CONDITIONAL 3 - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'cond_3', q: "If I had known about the problem, I ____ told you.", opts: ["would", "will", "would have", "had"], a: "C", exp: "C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 3 (tr√°i v·ªõi qu√° kh·ª©): If + S + had + V3, S + would have + V3.", trans: "N·∫øu l√∫c ƒë√≥ t√¥i bi·∫øt th√¨ t√¥i ƒë√£ n√≥i v·ªõi b·∫°n r·ªìi." },
    { type: 'mc', tag: 'cond_3', q: "If it hadn't rained yesterday, we ____ to the beach.", opts: ["went", "would go", "would have gone", "will go"], a: "C", exp: "V·∫ø k·∫øt qu·∫£ lo·∫°i 3: di·ªÖn t·∫£ m·ªôt vi·ªác ƒë√£ kh√¥ng x·∫£y ra trong qu√° kh·ª©.", trans: "N·∫øu h√¥m qua tr·ªùi kh√¥ng m∆∞a, ch√∫ng t√¥i ƒë√£ ƒëi bi·ªÉn r·ªìi." },
    { type: 'mc', tag: 'cond_3', q: "She would have passed the exam if she ____ harder.", opts: ["studied", "had studied", "would study", "studies"], a: "B", exp: "V·∫ø 'If' c·ªßa c√¢u ƒëi·ªÅu ki·ªán lo·∫°i 3 lu√¥n chia ·ªü th√¨ Qu√° kh·ª© ho√†n th√†nh (had + V3).", trans: "C√¥ ·∫•y ƒë√£ ƒë·∫≠u k·ª≥ thi n·∫øu c√¥ ·∫•y h·ªçc chƒÉm h∆°n." },
    { type: 'mc', tag: 'cond_3', q: "If they ____ earlier, they wouldn't have missed the train.", opts: ["left", "had left", "would leave", "leave"], a: "B", exp: "Gi·∫£ ƒë·ªãnh m·ªôt vi·ªác tr√°i v·ªõi th·ª±c t·∫ø ƒë√£ l·ª° t√†u: d√πng 'had left'.", trans: "N·∫øu h·ªç r·ªùi ƒëi s·ªõm h∆°n, h·ªç ƒë√£ kh√¥ng l·ª° chuy·∫øn t√†u." },
    { type: 'mc', tag: 'cond_3', q: "I ____ you if I had seen you at the mall.", opts: ["would help", "would have helped", "helped", "had helped"], a: "B", exp: "C·∫•u tr√∫c: would have + V3 di·ªÖn t·∫£ m·ªôt h√†nh ƒë·ªông c√≥ th·ªÉ ƒë√£ x·∫£y ra.", trans: "T√¥i ƒë√£ gi√∫p b·∫°n n·∫øu t√¥i nh√¨n th·∫•y b·∫°n ·ªü trung t√¢m th∆∞∆°ng m·∫°i." },
    { type: 'mc', tag: 'cond_3', q: "If he ____ the instructions, he wouldn't have made mistakes.", opts: ["followed", "had followed", "follows", "would follow"], a: "B", exp: "Di·ªÖn t·∫£ s·ª± h·ªëi ti·∫øc v·ªÅ m·ªôt vi·ªác kh√¥ng l√†m trong qu√° kh·ª©.", trans: "N·∫øu anh ·∫•y l√†m theo h∆∞·ªõng d·∫´n, anh ·∫•y ƒë√£ kh√¥ng m·∫Øc l·ªói." },
    { type: 'mc', tag: 'cond_3', q: "We ____ lost if we had taken a map with us.", opts: ["wouldn't have", "wouldn't", "hadn't", "didn't"], a: "A", exp: "L∆∞u √Ω: 'wouldn't have' + P.P (·ªü ƒë√¢y P.P 'gotten' ƒë∆∞·ª£c l∆∞·ª£c b·ªõt ho·∫∑c hi·ªÉu ng·∫ßm).", trans: "Ch√∫ng t√¥i ƒë√£ kh√¥ng b·ªã l·∫°c n·∫øu ch√∫ng t√¥i mang theo b·∫£n ƒë·ªì." },
    { type: 'mc', tag: 'cond_3', q: "If she ____ about the meeting, she would have attended.", opts: ["knew", "had known", "knows", "would know"], a: "B", exp: "S·ª± th·∫≠t l√† c√¥ ·∫•y kh√¥ng bi·∫øt, n√™n gi·∫£ ƒë·ªãnh d√πng Qu√° kh·ª© ho√†n th√†nh.", trans: "N·∫øu c√¥ ·∫•y bi·∫øt v·ªÅ cu·ªôc h·ªçp, c√¥ ·∫•y ƒë√£ tham d·ª± r·ªìi." },
    { type: 'mc', tag: 'cond_3', q: "They ____ the game if they had practiced more.", opts: ["would win", "would have won", "won", "had won"], a: "B", exp: "V·∫ø k·∫øt qu·∫£ lo·∫°i 3: would have + won (V3 c·ªßa win).", trans: "H·ªç ƒë√£ th·∫Øng tr·∫≠n ƒë·∫•u n·∫øu h·ªç luy·ªán t·∫≠p nhi·ªÅu h∆°n." },
    { type: 'mc', tag: 'cond_3', q: "If I ____ you were coming, I would have prepared dinner.", opts: ["know", "knew", "had known", "would know"], a: "C", exp: "D√πng ƒë·ªÉ di·ªÖn t·∫£ m·ªôt t√¨nh hu·ªëng gi·∫£ ƒë·ªãnh: If + S + had + V3.", trans: "N·∫øu t√¥i bi·∫øt b·∫°n s·∫Ω ƒë·∫øn, t√¥i ƒë√£ chu·∫©n b·ªã b·ªØa t·ªëi r·ªìi." },
    { type: 'order', tag: 'cond_3', q: "passed / you / had / if / studied harder / You / would / have", a: "You would have passed if you had studied harder.", exp: "V·∫ø k·∫øt qu·∫£ ƒë·ª©ng tr∆∞·ªõc, kh√¥ng c·∫ßn d·∫•u ph·∫©y.", trans: "B·∫°n ƒë√£ ƒë·∫≠u n·∫øu b·∫°n ch·ªãu h·ªçc chƒÉm ch·ªâ h∆°n." },
    { type: 'order', tag: 'cond_3', q: "known / I / had / If / I / would / have / called", a: "If I had known I would have called.", exp: "V·∫ø 'If' ƒë·ª©ng ƒë·∫ßu c·∫ßn c√≥ d·∫•u ph·∫©y ngƒÉn c√°ch.", trans: "N·∫øu t√¥i bi·∫øt, t√¥i ƒë√£ g·ªçi ƒëi·ªán r·ªìi." },
    { type: 'order', tag: 'cond_3', q: "rained / hadn't / If / it / gone / we / would / have / out", a: "If it hadn't rained we would have gone out.", exp: "Gi·∫£ ƒë·ªãnh ph·ªß ƒë·ªãnh trong qu√° kh·ª©.", trans: "N·∫øu tr·ªùi kh√¥ng m∆∞a, ch√∫ng t√¥i ƒë√£ ra ngo√†i r·ªìi." },
    { type: 'order', tag: 'cond_3', q: "would / have / if / he / tried harder / made it / He / had", a: "He would have made it if he had tried harder.", exp: "S + would have + V3 + if + S + had + V3.", trans: "Anh ·∫•y ƒë√£ l√†m ƒë∆∞·ª£c n·∫øu anh ·∫•y c·ªë g·∫Øng nhi·ªÅu h∆°n." },
    { type: 'order', tag: 'cond_3', q: "time / I'd / had / If / helped / would / have / I / you", a: "If I'd had time I would have helped you.", exp: "L∆∞u √Ω 'had had': tr·ª£ ƒë·ªông t·ª´ 'had' v√† ƒë·ªông t·ª´ ch√≠nh 'had' (V3).", trans: "N·∫øu t√¥i c√≥ th·ªùi gian, t√¥i ƒë√£ gi√∫p b·∫°n r·ªìi." },
    { type: 'order', tag: 'cond_3', q: "would / have / told / you / if / had / I / known / I", a: "I would have told you if I had known.", exp: "C·∫•u tr√∫c th√¥ng d·ª•ng di·ªÖn t·∫£ vi·ªác l·ª° m·∫•t c∆° h·ªôi.", trans: "T√¥i ƒë√£ n√≥i v·ªõi b·∫°n n·∫øu t√¥i bi·∫øt chuy·ªán ƒë√≥." },
    { type: 'order', tag: 'cond_3', q: "taken / If / umbrella / wouldn't / have / gotten / you / wet / you / had / an", a: "If you had taken an umbrella you wouldn't have gotten wet.", exp: "C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 3 d·∫°ng ph·ªß ƒë·ªãnh.", trans: "N·∫øu b·∫°n mang √¥ th√¨ b·∫°n ƒë√£ kh√¥ng b·ªã ∆∞·ªõt." },
    { type: 'order', tag: 'cond_3', q: "had / earlier / left / missed / wouldn't / have / They / flight / the / they / if", a: "They wouldn't have missed the flight if they had left earlier.", exp: "K·∫øt qu·∫£ ƒë·ª©ng tr∆∞·ªõc: wouldn't have + V3.", trans: "H·ªç ƒë√£ kh√¥ng l·ª° chuy·∫øn bay n·∫øu h·ªç r·ªùi ƒëi s·ªõm h∆°n." },
    { type: 'order', tag: 'cond_3', q: "would / have / they / won / if / practiced / more / They / had", a: "They would have won if they had practiced more.", exp: "Di·ªÖn t·∫£ m·ªôt k·∫øt qu·∫£ tr√°i v·ªõi th·ª±c t·∫ø ƒë√£ thua.", trans: "H·ªç ƒë√£ th·∫Øng n·∫øu h·ªç luy·ªán t·∫≠p nhi·ªÅu h∆°n." },
    { type: 'order', tag: 'cond_3', q: "hadn't / If / met him / I / moved / wouldn't / have / here / I", a: "If I hadn't met him I wouldn't have moved here.", exp: "C√¢u ƒëi·ªÅu ki·ªán lo·∫°i 3 d·∫°ng ph·ªß ƒë·ªãnh.", trans: "N·∫øu t√¥i kh√¥ng g·∫∑p anh ·∫•y, t√¥i ƒë√£ kh√¥ng chuy·ªÉn ƒë·∫øn ƒë√¢y." },
    
    // WISH - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'wish', q: "I don't have enough money. I wish I ____ rich.", opts: ["am", "will be", "were", "been"], a: "C", exp: "∆Ø·ªõc tr√°i v·ªõi hi·ªán t·∫°i: to be -> 'were' cho t·∫•t c·∫£ c√°c ng√¥i, was c√≥ th·ªÉ ƒë∆∞·ª£c d√πng trong vƒÉn n√≥i.", trans: "T√¥i ∆∞·ªõc g√¨ m√¨nh gi√†u c√≥ (th·ª±c t·∫ø l√† ƒëang ngh√®o)." },
    { type: 'mc', tag: 'wish', q: "I missed the bus this morning. I wish I ____ up earlier.", opts: ["get", "got", "had got", "have got"], a: "C", exp: "∆Ø·ªõc tr√°i v·ªõi qu√° kh·ª© (h·ªëi ti·∫øc): d√πng Qu√° kh·ª© ho√†n th√†nh (Had + V3).", trans: "T√¥i ∆∞·ªõc g√¨ m√¨nh ƒë√£ d·∫≠y s·ªõm h∆°n." },
    { type: 'mc', tag: 'wish', q: "I wish I ____ speak French fluently.", opts: ["can", "could", "will", "would"], a: "B", exp: "∆Ø·ªõc v·ªÅ kh·∫£ nƒÉng/nƒÉng l·ª±c: l√πi 'can' th√†nh 'could'.", trans: "T√¥i ∆∞·ªõc t√¥i c√≥ th·ªÉ n√≥i ti·∫øng Ph√°p tr√¥i ch·∫£y." },
    { type: 'mc', tag: 'wish', q: "She wishes she ____ taller to become a model.", opts: ["is", "was", "were", "be"], a: "C", exp: "∆Ø·ªõc tr√°i hi·ªán t·∫°i v·ªõi ƒë·ªông t·ª´ to be -> d√πng 'were', was c√≥ th·ªÉ ƒë∆∞·ª£c d√πng trong vƒÉn n√≥i.", trans: "C√¥ ·∫•y ∆∞·ªõc m√¨nh cao h∆°n ƒë·ªÉ l√†m ng∆∞·ªùi m·∫´u." },
    { type: 'mc', tag: 'wish', q: "It's so noisy outside. I wish it ____ stop raining.", opts: ["will", "would", "can", "could"], a: "B", exp: "∆Ø·ªõc m·ªôt s·ª± v·∫≠t/s·ª± vi·ªác thay ƒë·ªïi (th∆∞·ªùng mang t√≠nh ph√†n n√†n) -> d√πng 'would'.", trans: "Ngo√†i tr·ªùi ·ªìn qu√°. T√¥i ∆∞·ªõc g√¨ tr·ªùi ng·ª´ng m∆∞a (cho ƒë·ª° ·ªìn)." },
    { type: 'mc', tag: 'wish', q: "They wish they ____ bought that house last year.", opts: ["have", "had", "would have", "will have"], a: "B", exp: "H·ªëi ti·∫øc v·ªÅ m·ªôt vi·ªác ƒë√£ kh√¥ng l√†m trong qu√° kh·ª© -> Had + V3.", trans: "H·ªç ∆∞·ªõc l√† h·ªç ƒë√£ mua ng√¥i nh√† ƒë√≥ v√†o nƒÉm ngo√°i." },
    { type: 'mc', tag: 'wish', q: "You are being too loud! I wish you ____ be quiet.", opts: ["will", "would", "can", "could"], a: "B", exp: "Y√™u c·∫ßu ai ƒë√≥ thay ƒë·ªïi h√†nh vi g√¢y kh√≥ ch·ªãu -> d√πng 'would'.", trans: "T√¥i ∆∞·ªõc g√¨ b·∫°n c√≥ th·ªÉ im l·∫∑ng m·ªôt ch√∫t." },
    { type: 'mc', tag: 'wish', q: "He wishes he ____ a supercar like his friend.", opts: ["have", "had", "has", "having"], a: "B", exp: "∆Ø·ªõc v·ªÅ s·ªü h·ªØu ·ªü hi·ªán t·∫°i: l√πi ƒë·ªông t·ª´ v·ªÅ Qu√° kh·ª© ƒë∆°n (had).", trans: "Anh ·∫•y ∆∞·ªõc m√¨nh c√≥ m·ªôt chi·∫øc si√™u xe nh∆∞ b·∫°n anh ·∫•y." },
    { type: 'mc', tag: 'wish', q: "I wish I ____ known the answer during the test.", opts: ["know", "knew", "had known", "would know"], a: "C", exp: "H√†nh ƒë·ªông bi·∫øt ƒë√£ x·∫£y ra trong qu√° kh·ª© (l√∫c l√†m b√†i) -> d√πng QKHT.", trans: "T√¥i ∆∞·ªõc g√¨ l√∫c ƒë√≥ t√¥i ƒë√£ bi·∫øt c√¢u tr·∫£ l·ªùi." },
    { type: 'mc', tag: 'wish', q: "We wish we ____ on vacation right b√¢y gi·ªù.", opts: ["are", "were", "will be", "would be"], a: "B", exp: "∆Ø·ªõc v·ªÅ m·ªôt t√¨nh hu·ªëng hi·ªán t·∫°i ƒëang kh√¥ng c√≥ th·∫≠t.", trans: "Ch√∫ng t√¥i ∆∞·ªõc g√¨ m√¨nh ƒëang ƒëi ngh·ªâ m√°t." },
    { type: 'order', tag: 'wish', q: "could / fly / I / wish / I", a: "I wish I could fly.", exp: "Wish for ability: Wish + S + could + V.", trans: "T√¥i ∆∞·ªõc t√¥i c√≥ th·ªÉ bay." },
    { type: 'order', tag: 'wish', q: "wish / I / it / would / stop / raining", a: "I wish it would stop raining.", exp: "Wish for change with 'would'.", trans: "T√¥i ∆∞·ªõc tr·ªùi ng·ª´ng m∆∞a." },
    { type: 'order', tag: 'wish', q: "wish / I / I / knew / answer / the", a: "I wish I knew the answer.", exp: "Wish about present knowledge.", trans: "T√¥i ∆∞·ªõc t√¥i bi·∫øt c√¢u tr·∫£ l·ªùi." },
    { type: 'order', tag: 'wish', q: "wish / you / would / listen / I", a: "I wish you would listen.", exp: "Wish for someone to change behavior.", trans: "T√¥i ∆∞·ªõc b·∫°n s·∫Ω l·∫Øng nghe." },
    { type: 'order', tag: 'wish', q: "wish / they / had / come / they", a: "They wish they had come.", exp: "Regret about past action.", trans: "H·ªç ∆∞·ªõc h·ªç ƒë√£ ƒë·∫øn." },
    { type: 'order', tag: 'wish', q: "wish / I / were / I / taller", a: "I wish I were taller.", exp: "Wish about physical characteristic.", trans: "T√¥i ∆∞·ªõc t√¥i cao h∆°n." },
    { type: 'order', tag: 'wish', q: "wishes / she / could / she / sing / better", a: "She wishes she could sing better.", exp: "Wish for ability.", trans: "C√¥ ·∫•y ∆∞·ªõc c√¥ ·∫•y c√≥ th·ªÉ h√°t hay h∆°n." },
    { type: 'order', tag: 'wish', q: "wish / had / I / more / time / I", a: "I wish I had more time.", exp: "Wish about present possession.", trans: "T√¥i ∆∞·ªõc t√¥i c√≥ nhi·ªÅu th·ªùi gian h∆°n." },
    { type: 'order', tag: 'wish', q: "wish / we / on / were / beach / the", a: "We wish we were on the beach.", exp: "Wish about current location.", trans: "Ch√∫ng t√¥i ∆∞·ªõc ch√∫ng t√¥i ƒëang ·ªü b√£i bi·ªÉn." },
    { type: 'order', tag: 'wish', q: "wish / had / studied / I / harder / I", a: "I wish I had studied harder.", exp: "Regret about past study.", trans: "T√¥i ∆∞·ªõc t√¥i ƒë√£ h·ªçc chƒÉm ch·ªâ h∆°n." },
    
    // PASSIVE VOICE - 10 MC, 10 Order (ƒê√É S·ª¨A L·ªñI)
    { type: 'mc', tag: 'passive', q: "The cake ____ by my mom.", opts: ["bakes", "was baked", "baked", "is baking"], a: "B", exp: "C√¢u b·ªã ƒë·ªông: Be + V3. C√≥ 'by' (b·ªüi ai ƒë√≥) l√† d·∫•u hi·ªáu b·ªã ƒë·ªông.", trans: "C√°i b√°nh ƒë∆∞·ª£c n∆∞·ªõng b·ªüi m·∫π t√¥i." },
    { type: 'mc', tag: 'passive', q: "English ____ all over the world.", opts: ["speaks", "is spoken", "spoken", "speaking"], a: "B", exp: "S·ª± th·∫≠t hi·ªÉn nhi√™n d√πng b·ªã ƒë·ªông Hi·ªán t·∫°i ƒë∆°n: Is/Are + V3.", trans: "Ti·∫øng Anh ƒë∆∞·ª£c n√≥i tr√™n kh·∫Øp th·∫ø gi·ªõi." },
    { type: 'mc', tag: 'passive', q: "The letter ____ yesterday.", opts: ["was written", "is written", "wrote", "writing"], a: "A", exp: "D·∫•u hi·ªáu 'yesterday' -> B·ªã ƒë·ªông Qu√° kh·ª© ƒë∆°n: Was/Were + V3.", trans: "L√° th∆∞ ƒë√£ ƒë∆∞·ª£c vi·∫øt v√†o ng√†y h√¥m qua." },
    { type: 'mc', tag: 'passive', q: "The house ____ next year.", opts: ["will build", "will be built", "builds", "built"], a: "B", exp: "B·ªã ƒë·ªông T∆∞∆°ng lai ƒë∆°n: Will + be + V3.", trans: "Ng√¥i nh√† s·∫Ω ƒë∆∞·ª£c x√¢y d·ª±ng v√†o nƒÉm sau." },
    { type: 'mc', tag: 'passive', q: "Coffee ____ in Brazil.", opts: ["grows", "is grown", "grown", "growing"], a: "B", exp: "Di·ªÖn t·∫£ s·ª± th·∫≠t kh√°ch quan ·ªü hi·ªán t·∫°i: Is/Are + V3.", trans: "C√† ph√™ ƒë∆∞·ª£c tr·ªìng ·ªü Brazil." },
    { type: 'mc', tag: 'passive', q: "The car ____ at the moment.", opts: ["is repaired", "is being repaired", "repairs", "repaired"], a: "B", exp: "D·∫•u hi·ªáu 'at the moment' -> B·ªã ƒë·ªông Hi·ªán t·∫°i ti·∫øp di·ªÖn: Is/Are + being + V3.", trans: "Chi·∫øc xe ƒëang ƒë∆∞·ª£c s·ª≠a ngay l√∫c n√†y." },
    { type: 'mc', tag: 'passive', q: "The problem ____ by the engineer.", opts: ["solved", "was solved", "solves", "solving"], a: "B", exp: "Ch·ªß ng·ªØ s·ªë √≠t 'The problem' + was + V3.", trans: "V·∫•n ƒë·ªÅ ƒë√£ ƒë∆∞·ª£c gi·∫£i quy·∫øt b·ªüi k·ªπ s∆∞." },
    { type: 'mc', tag: 'passive', q: "Lunch ____ right now.", opts: ["is served", "is being served", "serves", "served"], a: "B", exp: "B·ªã ƒë·ªông Hi·ªán t·∫°i ti·∫øp di·ªÖn: Nh·∫•n m·∫°nh h√†nh ƒë·ªông ƒëang di·ªÖn ra.", trans: "B·ªØa tr∆∞a ƒëang ƒë∆∞·ª£c ph·ª•c v·ª• ngay b√¢y gi·ªù." },
    { type: 'mc', tag: 'passive', q: "The book ____ by millions of people.", opts: ["reads", "is read", "read", "reading"], a: "B", exp: "S·ª≠ d·ª•ng b·ªã ƒë·ªông hi·ªán t·∫°i ƒë·ªÉ n√≥i v·ªÅ m·ªôt th√≥i quen/s·ª± th·∫≠t.", trans: "Cu·ªën s√°ch ƒë∆∞·ª£c ƒë·ªçc b·ªüi h√†ng tri·ªáu ng∆∞·ªùi." },
    { type: 'mc', tag: 'passive', q: "The bridge ____ last month.", opts: ["was completed", "completed", "is completed", "completes"], a: "A", exp: "B·ªã ƒë·ªông Qu√° kh·ª© ƒë∆°n v·ªõi m·ªëc th·ªùi gian x√°c ƒë·ªãnh (last month).", trans: "C√¢y c·∫ßu ƒë√£ ƒë∆∞·ª£c ho√†n th√†nh v√†o th√°ng tr∆∞·ªõc." },
    { type: 'order', tag: 'passive', q: "built / was / house / this / in / 1990", a: "This house was built in 1990.", exp: "C·∫•u tr√∫c: Ch·ªß ng·ªØ + was/were + V3/ed.", trans: "Ng√¥i nh√† n√†y ƒë∆∞·ª£c x√¢y v√†o nƒÉm 1990." },
    { type: 'order', tag: 'passive', q: "be / will / work / the / done / tomorrow", a: "The work will be done tomorrow.", exp: "C·∫•u tr√∫c b·ªã ƒë·ªông t∆∞∆°ng lai: Will + be + V3.", trans: "C√¥ng vi·ªác s·∫Ω ƒë∆∞·ª£c ho√†n th√†nh v√†o ng√†y mai." },
    { type: 'order', tag: 'passive', q: "being / repaired / car / the / is", a: "The car is being repaired.", exp: "Nh·ªõ ph·∫£i c√≥ 'being' trong c√¢u b·ªã ƒë·ªông ti·∫øp di·ªÖn.", trans: "Chi·∫øc xe ƒëang ƒë∆∞·ª£c s·ª≠a ch·ªØa." },
    { type: 'order', tag: 'passive', q: "by / written / was / Shakespeare / play / the", a: "The play was written by Shakespeare.", exp: "By + t√°c gi·∫£ (Shakespeare) ƒë·ª©ng cu·ªëi c√¢u.", trans: "V·ªü k·ªãch ƒë∆∞·ª£c vi·∫øt b·ªüi Shakespeare." },
    { type: 'order', tag: 'passive', q: "is / coffee / grown / where / ?", a: "Where is coffee grown?", exp: "C√¢u h·ªèi b·ªã ƒë·ªông: Wh- + is/are + S + V3?", trans: "C√† ph√™ ƒë∆∞·ª£c tr·ªìng ·ªü ƒë√¢u?" },
    { type: 'order', tag: 'passive', q: "being / washed / over there / car / your / is", a: "Your car is being washed over there.", exp: "B·ªã ƒë·ªông hi·ªán t·∫°i ti·∫øp di·ªÖn.", trans: "Xe c·ªßa b·∫°n ƒëang ƒë∆∞·ª£c r·ª≠a ·ªü ƒë·∫±ng kia." },
    { type: 'order', tag: 'passive', q: "will / be / delivered / package / the / Monday / on", a: "The package will be delivered on Monday.", exp: "S + will be + V3 + th·ªùi gian.", trans: "G√≥i h√†ng s·∫Ω ƒë∆∞·ª£c giao v√†o th·ª© Hai." },
    { type: 'order', tag: 'passive', q: "from / made / cheese / milk / is", a: "Cheese is made from milk.", exp: "D√πng b·ªã ƒë·ªông ƒë·ªÉ n√≥i v·ªÅ ngu·ªìn g·ªëc nguy√™n li·ªáu.", trans: "Ph√¥ mai ƒë∆∞·ª£c l√†m t·ª´ s·ªØa." },
    { type: 'order', tag: 'passive', q: "was / invented / telephone / the / when / ?", a: "When was the telephone invented?", exp: "C√¢u h·ªèi b·ªã ƒë·ªông trong qu√° kh·ª©.", trans: "ƒêi·ªán tho·∫°i ƒë∆∞·ª£c ph√°t minh khi n√†o?" },
    { type: 'order', tag: 'passive', q: "being / cooked / dinner / is / now", a: "Dinner is being cooked now.", exp: "Hi·ªán t·∫°i ti·∫øp di·ªÖn d·∫°ng b·ªã ƒë·ªông.", trans: "B·ªØa t·ªëi ƒëang ƒë∆∞·ª£c n·∫•u b√¢y gi·ªù." },
    
    // COMPARATIVE ADJECTIVES - 10 MC, 10 Order (ƒê√É KI·ªÇM TRA - OK)
    { type: 'mc', tag: 'comp_adj', q: "My car is ____ than yours.", opts: ["fast", "faster", "more fast", "fastest"], a: "B", exp: "T√≠nh t·ª´ ng·∫Øn (1 √¢m ti·∫øt): Adj + er + than.", trans: "Xe c·ªßa t√¥i ch·∫°y nhanh h∆°n xe c·ªßa b·∫°n." },
    { type: 'mc', tag: 'comp_adj', q: "This problem is ____ than that one.", opts: ["easy", "easier", "more easy", "easiest"], a: "B", exp: "T√≠nh t·ª´ k·∫øt th√∫c b·∫±ng 'y': ƒê·ªïi 'y' th√†nh 'i' r·ªìi th√™m 'er'.", trans: "V·∫•n ƒë·ªÅ n√†y d·ªÖ h∆°n v·∫•n ƒë·ªÅ kia." },
    { type: 'mc', tag: 'comp_adj', q: "She is ____ than her sister.", opts: ["more beautiful", "beautifuller", "beautifuler", "beautiful"], a: "A", exp: "T√≠nh t·ª´ d√†i (3 √¢m ti·∫øt): more + Adj + than.", trans: "C√¥ ·∫•y xinh ƒë·∫πp h∆°n ch·ªã g√°i m√¨nh." },
    { type: 'mc', tag: 'comp_adj', q: "Today is ____ than yesterday.", opts: ["cold", "colder", "coldest", "more cold"], a: "B", exp: "Cold l√† t√≠nh t·ª´ ng·∫Øn -> colder.", trans: "H√¥m nay l·∫°nh h∆°n h√¥m qua." },
    { type: 'mc', tag: 'comp_adj', q: "This box is ____ than that one.", opts: ["heavier", "heavy", "heaviest", "more heavy"], a: "A", exp: "Heavy (k·∫øt th√∫c b·∫±ng y) -> heavier.", trans: "C√°i h·ªôp n√†y n·∫∑ng h∆°n c√°i kia." },
    { type: 'mc', tag: 'comp_adj', q: "He is ____ than me at math.", opts: ["good", "better", "best", "more good"], a: "B", exp: "Tr∆∞·ªùng h·ª£p b·∫•t quy t·∫Øc: Good chuy·ªÉn th√†nh Better.", trans: "Anh ·∫•y gi·ªèi to√°n h∆°n t√¥i." },
    { type: 'mc', tag: 'comp_adj', q: "The movie was ____ than the book.", opts: ["interesting", "more interesting", "interestinger", "most interesting"], a: "B", exp: "Interesting l√† t√≠nh t·ª´ d√†i -> d√πng 'more'.", trans: "B·ªô phim th√∫ v·ªã h∆°n cu·ªën s√°ch." },
    { type: 'mc', tag: 'comp_adj', q: "This test is ____ than the last one.", opts: ["difficult", "difficulter", "more difficult", "most difficult"], a: "C", exp: "Difficult l√† t√≠nh t·ª´ d√†i -> more difficult.", trans: "B√†i ki·ªÉm tra n√†y kh√≥ h∆°n b√†i tr∆∞·ªõc." },
    { type: 'mc', tag: 'comp_adj', q: "She is ____ than her brother.", opts: ["tall", "taller", "tallest", "more tall"], a: "B", exp: "Tall l√† t√≠nh t·ª´ ng·∫Øn -> taller.", trans: "C√¥ ·∫•y cao h∆°n anh trai m√¨nh." },
    { type: 'mc', tag: 'comp_adj', q: "My room is ____ than yours.", opts: ["big", "bigger", "biggest", "more big"], a: "B", exp: "Quy t·∫Øc 1 nguy√™n √¢m k·∫πp gi·ªØa 2 ph·ª• √¢m: G·∫•p ƒë√¥i ph·ª• √¢m cu·ªëi (bigger).", trans: "Ph√≤ng c·ªßa t√¥i l·ªõn h∆°n ph√≤ng c·ªßa b·∫°n." },
    { type: 'order', tag: 'comp_adj', q: "taller / is / Tom / me / than", a: "Tom is taller than me.", exp: "S + be + adj-er + than + O.", trans: "Tom cao h∆°n t√¥i." },
    { type: 'order', tag: 'comp_adj', q: "more / is / beautiful / She / sister / her / than", a: "She is more beautiful than her sister.", exp: "Long adjective: more + adj.", trans: "C√¥ ·∫•y xinh h∆°n ch·ªã c√¥ ·∫•y." },
    { type: 'order', tag: 'comp_adj', q: "than / healthier / My mom / is / my dad", a: "My mom is healthier than my dad.", exp: "ƒê·ªïi y th√†nh i r·ªìi th√™m er.", trans: "M·∫π t√¥i kho·∫ª m·∫°nh h∆°n ba t√¥i." },
    { type: 'order', tag: 'comp_adj', q: "expensive / car / is / my / yours / than / more", a: "My car is more expensive than yours.", exp: "Comparative with expensive.", trans: "Xe t√¥i ƒë·∫Øt h∆°n xe b·∫°n." },
    { type: 'order', tag: 'comp_adj', q: "than / better / am / I / you / at / singing", a: "I am better than you at singing.", exp: "Irregular comparative: good -> better.", trans: "T√¥i h√°t hay h∆°n b·∫°n." },
    { type: 'order', tag: 'comp_adj', q: "is / weather / today / The / than / worse / yesterday", a: "The weather today is worse than yesterday.", exp: "Bad -> worse (irregular).", trans: "Th·ªùi ti·∫øt h√¥m nay t·ªá h∆°n h√¥m qua." },
    { type: 'order', tag: 'comp_adj', q: "than / faster / bus / train / the / is / the", a: "The train is faster than the bus.", exp: "Short adjective comparative.", trans: "T√†u nhanh h∆°n xe bu√Ωt." },
    { type: 'order', tag: 'comp_adj', q: "more / careful / be / you / should", a: "You should be more careful.", exp: "Comparative with modal verb.", trans: "B·∫°n n√™n c·∫©n th·∫≠n h∆°n." },
    { type: 'order', tag: 'comp_adj', q: "want / easier / job / I / an", a: "I want an easier job.", exp: "Easy -> easier (y to i).", trans: "T√¥i mu·ªën m·ªôt c√¥ng vi·ªác d·ªÖ h∆°n." },
    { type: 'order', tag: 'comp_adj', q: "than / happier / She / is / me", a: "She is happier than me.", exp: "Happy -> happier.", trans: "C√¥ ·∫•y h·∫°nh ph√∫c h∆°n t√¥i." },
    
    // SUPERLATIVE ADJECTIVES - 10 MC, 10 Order (ƒê√É KI·ªÇM TRA - OK)
    { type: 'mc', tag: 'sup_adj', q: "He is the ____ boy in my class.", opts: ["smart", "smarter", "smartest", "most smart"], a: "C", exp: "T√≠nh t·ª´ ng·∫Øn (1 √¢m ti·∫øt): d√πng c·∫•u tr√∫c 'the + Adj-est'.", trans: "Anh ·∫•y l√† c·∫≠u b√© th√¥ng minh nh·∫•t l·ªõp t√¥i." },
    { type: 'mc', tag: 'sup_adj', q: "This is the ____ movie I have ever seen.", opts: ["good", "best", "better", "goodest"], a: "B", exp: "Tr∆∞·ªùng h·ª£p b·∫•t quy t·∫Øc: Good -> Better (h∆°n) -> Best (nh·∫•t).", trans: "ƒê√¢y l√† b·ªô phim hay nh·∫•t m√† t√¥i t·ª´ng xem." },
    { type: 'mc', tag: 'sup_adj', q: "Mount Everest is the ____ mountain in the world.", opts: ["high", "higher", "highest", "most high"], a: "C", exp: "High l√† t√≠nh t·ª´ ng·∫Øn: th√™m ƒëu√¥i -est v√† ph·∫£i c√≥ 'the' ph√≠a tr∆∞·ªõc.", trans: "ƒê·ªânh Everest l√† ng·ªçn n√∫i cao nh·∫•t th·∫ø gi·ªõi." },
    { type: 'mc', tag: 'sup_adj', q: "She is the ____ student in school.", opts: ["intelligent", "most intelligent", "intelligenter", "more intelligent"], a: "B", exp: "T√≠nh t·ª´ d√†i (3 √¢m ti·∫øt): d√πng c·∫•u tr√∫c 'the most + Adj'.", trans: "C√¥ ·∫•y l√† h·ªçc sinh th√¥ng minh nh·∫•t tr∆∞·ªùng." },
    { type: 'mc', tag: 'sup_adj', q: "This is the ____ day of my life.", opts: ["happy", "happier", "happiest", "most happy"], a: "C", exp: "T√≠nh t·ª´ 2 √¢m ti·∫øt k·∫øt th√∫c b·∫±ng 'y': ƒë·ªïi 'y' th√†nh 'i' r·ªìi th√™m 'est'.", trans: "ƒê√¢y l√† ng√†y h·∫°nh ph√∫c nh·∫•t ƒë·ªùi t√¥i." },
    { type: 'mc', tag: 'sup_adj', q: "It's the ____ building in the city.", opts: ["tall", "taller", "tallest", "most tall"], a: "C", exp: "Tall l√† t√≠nh t·ª´ ng·∫Øn -> the tallest.", trans: "ƒê√≥ l√† t√≤a nh√† cao nh·∫•t th√†nh ph·ªë." },
    { type: 'mc', tag: 'sup_adj', q: "This is the ____ chocolate I've ever tasted.", opts: ["bad", "worse", "worst", "most bad"], a: "C", exp: "Tr∆∞·ªùng h·ª£p b·∫•t quy t·∫Øc: Bad -> Worse (t·ªá h∆°n) -> Worst (t·ªá nh·∫•t).", trans: "ƒê√¢y l√† lo·∫°i chocolate t·ªá nh·∫•t t√¥i t·ª´ng n·∫øm." },
    { type: 'mc', tag: 'sup_adj', q: "She told the ____ story at the party.", opts: ["funny", "funnier", "funniest", "most funny"], a: "C", exp: "Funny k·∫øt th√∫c b·∫±ng 'y' -> the funniest.", trans: "C√¥ ·∫•y ƒë√£ k·ªÉ c√¢u chuy·ªán bu·ªìn c∆∞·ªùi nh·∫•t trong b·ªØa ti·ªác." },
    { type: 'mc', tag: 'sup_adj', q: "This is the ____ restaurant in town.", opts: ["expensive", "more expensive", "most expensive", "expensivest"], a: "C", exp: "Expensive l√† t√≠nh t·ª´ d√†i -> d√πng 'the most expensive'.", trans: "ƒê√¢y l√† nh√† h√†ng ƒë·∫Øt nh·∫•t th·ªã tr·∫•n." },
    { type: 'mc', tag: 'sup_adj', q: "He's the ____ person I know.", opts: ["kind", "kinder", "kindest", "most kind"], a: "C", exp: "Kind l√† t√≠nh t·ª´ ng·∫Øn -> d√πng 'the kindest'.", trans: "Anh ·∫•y l√† ng∆∞·ªùi t·ª≠ t·∫ø nh·∫•t t√¥i bi·∫øt." },
    { type: 'order', tag: 'sup_adj', q: "biggest / the / Russia / country / is", a: "Russia is the biggest country.", exp: "C·∫•u tr√∫c: S + be + the + Adj-est + Noun.", trans: "Nga l√† qu·ªëc gia l·ªõn nh·∫•t." },
    { type: 'order', tag: 'sup_adj', q: "subject / difficult / most / the / is / Math", a: "Math is the most difficult subject.", exp: "V·ªõi t√≠nh t·ª´ d√†i, 'the most' lu√¥n ƒë·ª©ng tr∆∞·ªõc t√≠nh t·ª´.", trans: "To√°n l√† m√¥n h·ªçc kh√≥ nh·∫•t." },
    { type: 'order', tag: 'sup_adj', q: "the / is / best / player / he / team / in / the", a: "He is the best player in the team.", exp: "So s√°nh nh·∫•t b·∫•t quy t·∫Øc c·ªßa 'good' l√† 'the best'.", trans: "Anh ·∫•y l√† c·∫ßu th·ªß gi·ªèi nh·∫•t ƒë·ªôi." },
    { type: 'order', tag: 'sup_adj', q: "the / most / she / is / girl / beautiful", a: "She is the most beautiful girl.", exp: "S·∫Øp x·∫øp: Ch·ªß ng·ªØ + be + the most + t√≠nh t·ª´ d√†i + danh t·ª´.", trans: "C√¥ ·∫•y l√† c√¥ g√°i xinh ƒë·∫πp nh·∫•t." },
    { type: 'order', tag: 'sup_adj', q: "tallest / building / world / the / in / is / the / what / ?", a: "What is the tallest building in the world?", exp: "C√¢u h·ªèi v·ªõi t·ª´ ƒë·ªÉ h·ªèi: Wh- + be + the + Adj-est...?", trans: "T√≤a nh√† cao nh·∫•t th·∫ø gi·ªõi l√† t√≤a nh√† n√†o?" },
    { type: 'order', tag: 'sup_adj', q: "the / funniest / movie / is / this / ever", a: "This is the funniest movie ever.", exp: "'Ever' th∆∞·ªùng ƒë·ª©ng cu·ªëi c√¢u trong c·∫•u tr√∫c so s√°nh nh·∫•t ƒë·ªÉ nh·∫•n m·∫°nh.", trans: "ƒê√¢y l√† b·ªô phim h√†i h∆∞·ªõc nh·∫•t t·ª´ tr∆∞·ªõc ƒë·∫øn nay." },
    { type: 'order', tag: 'sup_adj', q: "most / important / thing / the / is / health", a: "Health is the most important thing.", exp: "T√≠nh t·ª´ d√†i 'important' ƒëi v·ªõi 'the most'.", trans: "S·ª©c kh·ªèe l√† ƒëi·ªÅu quan tr·ªçng nh·∫•t." },
    { type: 'order', tag: 'sup_adj', q: "the / smallest / planet / is / Mercury", a: "Mercury is the smallest planet.", exp: "Small l√† t√≠nh t·ª´ ng·∫Øn -> the smallest.", trans: "Sao Th·ªßy l√† h√†nh tinh nh·ªè nh·∫•t." },
    { type: 'order', tag: 'sup_adj', q: "the / richest / man / world / in / is / who / the / ?", a: "Who is the richest man in the world?", exp: "C√¢u h·ªèi t√¨m ki·∫øm ƒë·ªëi t∆∞·ª£ng ƒë·ª©ng nh·∫•t (the richest).", trans: "Ai l√† ng∆∞·ªùi gi√†u nh·∫•t th·∫ø gi·ªõi?" },
    { type: 'order', tag: 'sup_adj', q: "worst / my / is / day / this / ever", a: "This is my worst day ever.", exp: "L∆∞u √Ω: Khi c√≥ t√≠nh t·ª´ s·ªü h·ªØu 'my', ch√∫ng ta kh√¥ng d√πng 'the' tr∆∞·ªõc 'worst'.", trans: "ƒê√¢y l√† ng√†y t·ªá nh·∫•t c·ªßa t√¥i t·ª´ tr∆∞·ªõc t·ªõi gi·ªù." },
    
    // POSSESSIVE CASE - 10 MC, 10 Order (ƒê√É KI·ªÇM TRA - OK)
    { type: 'mc', tag: 'possessive', q: "This is ____ car.", opts: ["Tom", "Tom's", "Toms", "Toms'"], a: "B", exp: "S·ªü h·ªØu c√°ch v·ªõi t√™n ri√™ng s·ªë √≠t: th√™m 's v√†o sau t√™n.", trans: "ƒê√¢y l√† xe c·ªßa Tom." },
    { type: 'mc', tag: 'possessive', q: "The ____ room is messy.", opts: ["children", "childs", "children's", "childrens'"], a: "C", exp: "Danh t·ª´ s·ªë nhi·ªÅu b·∫•t quy t·∫Øc (kh√¥ng c√≥ 's' ·ªü cu·ªëi): v·∫´n th√™m 's nh∆∞ danh t·ª´ s·ªë √≠t.", trans: "Ph√≤ng c·ªßa b·ªçn tr·∫ª r·∫•t b·ª´a b·ªôn." },
    { type: 'mc', tag: 'possessive', q: "Is this ____ bag?", opts: ["you", "your", "yours", "your's"], a: "B", exp: "T√≠nh t·ª´ s·ªü h·ªØu (Your) lu√¥n ƒë·ª©ng tr∆∞·ªõc danh t·ª´.", trans: "ƒê√¢y c√≥ ph·∫£i l√† c√°i t√∫i c·ªßa b·∫°n kh√¥ng?" },
    { type: 'mc', tag: 'possessive', q: "That book is ____.", opts: ["my", "mine", "me", "I"], a: "B", exp: "ƒê·∫°i t·ª´ s·ªü h·ªØu (Mine) ƒë·ª©ng m·ªôt m√¨nh, d√πng ƒë·ªÉ thay th·∫ø cho 'my book'.", trans: "Quy·ªÉn s√°ch ƒë√≥ l√† c·ªßa t√¥i." },
    { type: 'mc', tag: 'possessive', q: "These are ____ shoes.", opts: ["Johns", "John's", "Johns'", "John"], a: "B", exp: "S·ªü h·ªØu c·ªßa John (s·ªë √≠t) -> John's.", trans: "ƒê√¢y l√† ƒë√¥i gi√†y c·ªßa John." },
    { type: 'mc', tag: 'possessive', q: "The ____ tails are fluffy.", opts: ["cats", "cat's", "cats'", "cats's"], a: "C", exp: "Danh t·ª´ s·ªë nhi·ªÅu c√≥ 's': ch·ªâ c·∫ßn th√™m d·∫•u nh√°y ƒë∆°n (') v√†o cu·ªëi.", trans: "ƒêu√¥i c·ªßa nh·ªØng con m√®o r·∫•t m∆∞·ª£t." },
    { type: 'mc', tag: 'possessive', q: "That is ____ house.", opts: ["James", "James'", "James's", "B or C"], a: "D", exp: "T√™n ri√™ng k·∫øt th√∫c b·∫±ng 's': c√≥ th·ªÉ th√™m ' ho·∫∑c 's ƒë·ªÅu ƒë√∫ng ng·ªØ ph√°p.", trans: "ƒê√≥ l√† nh√† c·ªßa James." },
    { type: 'mc', tag: 'possessive', q: "This pen is ____.", opts: ["her", "hers", "she", "her's"], a: "B", exp: "ƒê·∫°i t·ª´ s·ªü h·ªØu (Hers) ƒë·ª©ng cu·ªëi c√¢u, thay th·∫ø cho 'her pen'.", trans: "C√¢y b√∫t n√†y l√† c·ªßa c√¥ ·∫•y." },
    { type: 'mc', tag: 'possessive', q: "____ parents are doctors.", opts: ["He", "His", "Him", "He's"], a: "B", exp: "S·ª≠ d·ª•ng t√≠nh t·ª´ s·ªü h·ªØu (His) ƒë·ª©ng tr∆∞·ªõc danh t·ª´ 'parents'.", trans: "B·ªë m·∫π anh ·∫•y l√† b√°c sƒ©." },
    { type: 'mc', tag: 'possessive', q: "The ____ engine is loud.", opts: ["car", "cars", "car's", "cars'"], a: "C", exp: "S·ªü h·ªØu c·ªßa v·∫≠t s·ªë √≠t: Car + 's.", trans: "ƒê·ªông c∆° c·ªßa chi·∫øc xe r·∫•t ·ªìn." },
    { type: 'order', tag: 'possessive', q: "friend / mine / of / a / is / she", a: "She is a friend of mine.", exp: "C·∫•u tr√∫c s·ªü h·ªØu k√©p: a friend of + ƒë·∫°i t·ª´ s·ªü h·ªØu.", trans: "C√¥ ·∫•y l√† m·ªôt ng∆∞·ªùi b·∫°n c·ªßa t√¥i." },
    { type: 'order', tag: 'possessive', q: "tail / dog's / the / wagging / is", a: "The dog's tail is wagging.", exp: "S·ªü h·ªØu c√°ch: C√°i ƒëu√¥i c·ªßa con ch√≥.", trans: "ƒêu√¥i con ch√≥ ƒëang v·∫´y." },
    { type: 'order', tag: 'possessive', q: "my / is / this / parents' / house", a: "This is my parents' house.", exp: "Parents l√† s·ªë nhi·ªÅu c√≥ 's' n√™n ch·ªâ th√™m d·∫•u nh√°y ƒë∆°n.", trans: "ƒê√¢y l√† nh√† c·ªßa b·ªë m·∫π t√¥i." },
    { type: 'order', tag: 'possessive', q: "whose / book / this / is / ?", a: "Whose book is this?", exp: "Whose d√πng ƒë·ªÉ h·ªèi v·ªÅ s·ª± s·ªü h·ªØu.", trans: "ƒê√¢y l√† s√°ch c·ªßa ai?" },
    { type: 'order', tag: 'possessive', q: "sister / my / name / is / Anna", a: "My sister's name is Anna.", exp: "S·ªü h·ªØu c√°ch cho m·ªëi quan h·ªá: T√™n c·ªßa ch·ªã t√¥i.", trans: "T√™n ch·ªã t√¥i l√† Anna." },
    { type: 'order', tag: 'possessive', q: "children / toys / my / are / these", a: "These are my children's toys.", exp: "Children (s·ªë nhi·ªÅu) + 's + toys.", trans: "ƒê√¢y l√† ƒë·ªì ch∆°i c·ªßa b·ªçn tr·∫ª con t√¥i." },
    { type: 'order', tag: 'possessive', q: "car / color / what / is / your / ?", a: "What color is your car?", exp: "T√≠nh t·ª´ s·ªü h·ªØu 'your' b·ªï nghƒ©a cho 'car'.", trans: "Xe b·∫°n m√†u g√¨?" },
    { type: 'order', tag: 'possessive', q: "boss / office / My / is / big", a: "My boss's office is big.", exp: "VƒÉn ph√≤ng c·ªßa √¥ng ch·ªß (s·ªë √≠t).", trans: "VƒÉn ph√≤ng c·ªßa √¥ng ch·ªß t√¥i r·∫•t l·ªõn." },
    { type: 'order', tag: 'possessive', q: "hers / not / is / bag / this", a: "This bag is not hers.", exp: "S·ª≠ d·ª•ng ƒë·∫°i t·ª´ s·ªü h·ªØu 'hers' ƒë·ª©ng m·ªôt m√¨nh.", trans: "C√°i t√∫i n√†y kh√¥ng ph·∫£i c·ªßa c√¥ ·∫•y." },
    { type: 'order', tag: 'possessive', q: "teachers / lounge / the / is / where / ?", a: "Where is the teachers' lounge?", exp: "Ph√≤ng c·ªßa (nhi·ªÅu) gi√°o vi√™n: Teachers + d·∫•u nh√°y ƒë∆°n.", trans: "Ph√≤ng gi√°o vi√™n ·ªü ƒë√¢u?" }
];

    // Helper to generate more variations if needed (Duplicates DB to ensure enough pool size for single category selection)
    const extraDb = JSON.parse(JSON.stringify(db)); // Deep copy
    const fullDb = [...db, ...extraDb, ...JSON.parse(JSON.stringify(db))]; // Triple the DB to be safe

    // STATE
    let currentQuiz = { mc: [], order: [] };
    
    // SETUP LOGIC
    document.getElementById('fileInput').addEventListener('change', (e) => {
        if(e.target.files.length > 0) {
            document.getElementById('fileStatus').innerText = "Analysis Complete: Context Loaded.";
        }
    });

    function startTest() {
        const checkboxes = document.querySelectorAll('input[name="grammar"]:checked');
        const errorMsg = document.getElementById('selection-error');
        
        if (checkboxes.length < 1 || checkboxes.length > 3) {
            errorMsg.style.display = 'block';
            return;
        }
        errorMsg.style.display = 'none';

        const selectedTags = Array.from(checkboxes).map(c => c.value);
        
        // Filter DB
        const relevant = fullDb.filter(item => selectedTags.includes(item.tag));
        
        // Separate and Shuffle
        const mcPool = shuffle(relevant.filter(i => i.type === 'mc'));
        const orderPool = shuffle(relevant.filter(i => i.type === 'order'));

        // Select exactly 10 Unique
        currentQuiz.mc = getUnique(mcPool, 10);
        currentQuiz.order = getUnique(orderPool, 10);

        renderQuiz();
    }

    function getUnique(pool, count) {
        // Simple duplicate removal based on Question text
        const unique = [];
        const seen = new Set();
        
        for(let item of pool) {
            if(!seen.has(item.q)) {
                unique.push(item);
                seen.add(item.q);
            }
            if(unique.length === count) break;
        }
        return unique;
    }

    function shuffle(array) {
        let currentIndex = array.length, randomIndex;
        const newArr = [...array];
        while (currentIndex != 0) {
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex--;
            [newArr[currentIndex], newArr[randomIndex]] = [newArr[randomIndex], newArr[currentIndex]];
        }
        return newArr;
    }

    // RENDER LOGIC
    function renderQuiz() {
        document.getElementById('setup-view').classList.add('hidden');
        document.getElementById('test-view').classList.remove('hidden');

        // Render MC
        const mcContainer = document.getElementById('mc-container');
        currentQuiz.mc.forEach((q, idx) => {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.innerHTML = `
                <div class="q-title"><span>${idx + 1}. ${q.q}</span></div>
                <div class="mc-options">
                    ${q.opts.map((opt, oid) => `
                        <label class="mc-label">
                            <input type="radio" name="mc_${idx}" value="${opt}">
                            ${String.fromCharCode(65+oid)}. ${opt}
                        </label>
                    `).join('')}
                </div>
                <div id="fb-mc-${idx}" class="feedback-box"></div>
            `;
            mcContainer.appendChild(card);
        });

        // Render Reordering (Interactive)
        const orderContainer = document.getElementById('order-container');
        currentQuiz.order.forEach((q, idx) => {
            const words = shuffle(q.q.split(' / ')); // Split by delimiter in DB
            
            const card = document.createElement('div');
            card.className = 'question-card';
            
            card.innerHTML = `
                <div class="q-title"><span>${idx + 1}. Arrange the sentence:</span></div>
                
                <div class="reorder-area" id="ans-area-${idx}" onclick="returnWord(event, 'pool-${idx}')">
                    <span style="color:#cbd5e1; font-size:0.9em; pointer-events:none;" id="placeholder-${idx}">Tap words below to add here...</span>
                </div>

                <div class="word-bank" id="pool-${idx}">
                    ${words.map((w, wid) => `
                        <button class="word-chip" id="w-${idx}-${wid}" onclick="selectWord('w-${idx}-${wid}', 'ans-area-${idx}', 'placeholder-${idx}')">${w}</button>
                    `).join('')}
                </div>
                <input type="hidden" id="input-order-${idx}" value="">
                <div id="fb-order-${idx}" class="feedback-box"></div>
            `;
            orderContainer.appendChild(card);
        });
        
        window.scrollTo(0, 0);
    }

    // INTERACTIVE REORDERING FUNCTIONS
    window.selectWord = function(wordId, targetAreaId, placeholderId) {
        const btn = document.getElementById(wordId);
        const target = document.getElementById(targetAreaId);
        const placeholder = document.getElementById(placeholderId);
        
        // Move button visually
        target.appendChild(btn);
        btn.classList.add('in-answer');
        
        // Change onclick to allow removing
        btn.onclick = function() { removeWord(wordId, btn.parentElement.id.replace('ans-area', 'pool'), placeholderId); };
        
        if(placeholder) placeholder.style.display = 'none';
    };

    window.removeWord = function(wordId, poolId, placeholderId) {
        // Logic to return word to pool is tricky because we lost the pool ref in the onclick.
        // We can infer pool ID from the word ID struct: w-{idx}-{wid} -> pool-{idx}
        const parts = wordId.split('-');
        const realPoolId = `pool-${parts[1]}`;
        
        const btn = document.getElementById(wordId);
        const pool = document.getElementById(realPoolId);
        const ansArea = btn.parentElement;
        
        pool.appendChild(btn);
        btn.classList.remove('in-answer');
        
        // Reset Onclick
        btn.onclick = function() { selectWord(wordId, ansArea.id, placeholderId); };

        if(ansArea.children.length <= 1) { // 1 because placeholder is there
             const ph = document.getElementById(placeholderId);
             if(ph) ph.style.display = 'inline';
        }
    };

    // GRADING
    function submitAnswers() {
        let score = 0;
        
        // Grade MC
        currentQuiz.mc.forEach((q, idx) => {
            const selected = document.querySelector(`input[name="mc_${idx}"]:checked`);
            const fb = document.getElementById(`fb-mc-${idx}`);
            const isCorrect = selected && (selected.value === q.opts.find(o => o.startsWith(q.a) || q.opts.indexOf(selected.value) === (q.a.charCodeAt(0)-65) )); // Logic to match Letter or Value
            
            // Simplified matching: In this DB, A/B/C maps to index 0/1/2
            const correctIndex = q.a.charCodeAt(0) - 65;
            const correctText = q.opts[correctIndex];
            
            fb.style.display = 'block';
            
            if (selected && selected.value === correctText) {
                score++;
                fb.className = "feedback-box feedback-correct";
                fb.innerHTML = `<strong>Correct!</strong> <div class="explanation-text">üí° ${q.exp}<br>üìù ${q.trans}</div>`;
            } else {
                fb.className = "feedback-box feedback-wrong";
                fb.innerHTML = `<strong>Incorrect.</strong> Correct: ${q.a}. ${correctText} <div class="explanation-text">üí° ${q.exp}<br>üìù ${q.trans}</div>`;
            }
        });

        // Grade Order
        currentQuiz.order.forEach((q, idx) => {
            const ansArea = document.getElementById(`ans-area-${idx}`);
            // Get text of buttons inside ansArea
            const userWords = Array.from(ansArea.querySelectorAll('button')).map(b => b.innerText);
            const userSent = userWords.join(' ');
            
            const fb = document.getElementById(`fb-order-${idx}`);
            fb.style.display = 'block';

            // Normalize for comparison (remove punctuation, lower case)
            const cleanUser = userSent.toLowerCase().replace(/[^\w\s]/g, '').trim();
            const cleanCorrect = q.a.toLowerCase().replace(/[^\w\s]/g, '').trim();

            if (cleanUser === cleanCorrect && cleanUser.length > 0) {
                score++;
                fb.className = "feedback-box feedback-correct";
                fb.innerHTML = `<strong>Correct!</strong> <div class="explanation-text">üí° ${q.exp}<br>üìù ${q.trans}</div>`;
            } else {
                fb.className = "feedback-box feedback-wrong";
                fb.innerHTML = `<strong>Incorrect.</strong><br>Answer: <em>${q.a}</em> <div class="explanation-text">üí° ${q.exp}<br>üìù ${q.trans}</div>`;
            }
        });

        // Show Score
        const scorePanel = document.getElementById('score-panel');
        scorePanel.style.display = 'block';
        document.getElementById('final-score').innerText = score;
        const percentage = Math.round((score / 20) * 100);
        document.getElementById('score-percent').innerText = `${percentage}%`;
        
        // Add encouragement message
        let message = "";
        if (percentage >= 90) message = "Excellent! üéâ";
        else if (percentage >= 70) message = "Good job! üëç";
        else if (percentage >= 50) message = "Not bad! Keep practicing. üí™";
        else message = "Keep studying! You'll improve. üìö";
        
        document.getElementById('score-percent').innerHTML += `<div style="font-size:1rem; margin-top:5px;">${message}</div>`;
        
        // Scroll to top
        window.scrollTo({top: 0, behavior: 'smooth'});
        
        document.getElementById('submit-btn').classList.add('hidden');
        document.getElementById('retry-btn').classList.remove('hidden');
        
        // Disable interactions
        const allInputs = document.querySelectorAll('input, button.word-chip');
        allInputs.forEach(el => el.disabled = true);
    }
</script>

</body>
</html>
