<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Be Heard | Word Master</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Palette - EXACTLY SAME AS BEFORE */
            --primary: #031383;       /* Deep Royal Blue */
            --primary-dark: #020c5e;
            --accent: #FFD93D;        /* Sunny Yellow */
            --action: #FF6B6B;        /* Coral/Pink */
            --action-dark: #e04f4f;
            --bg: #EEF2FF;            /* Very light blue tint */
            --card-bg: #ffffff;
            --text: #031383;
            --success: #6BCB77;
            --danger: #FF6B6B;
        }

        body {
            /* Font changed to Nunito */
            font-family: 'Nunito', sans-serif;
            background: var(--bg);
            /* Background pattern kept exactly same */
            background-image: radial-gradient(#dbeafe 15%, transparent 16%), radial-gradient(#dbeafe 15%, transparent 16%);
            background-size: 20px 20px;
            background-position: 0 0, 10px 10px;
            color: var(--text);
            margin: 0; padding: 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 800px; margin: 20px auto;
            background: var(--card-bg);
            padding: 40px; 
            border-radius: 30px;
            box-shadow: 0 10px 0 rgba(3, 19, 131, 0.1);
            border: 3px solid #dae1f5;
        }

        /* --- Header --- */
        .header { text-align: center; margin-bottom: 35px; }
        .header h1 { 
            color: var(--primary); 
            font-size: 2.8rem; 
            margin-bottom: 5px; 
            text-shadow: 2px 2px 0px #dae1f5;
            font-weight: 800; /* Extra bold looks cuter in Nunito */
            letter-spacing: -1px;
        }
        .header p { color: #667eea; font-weight: 700; font-size: 1.1rem; }
        
        /* --- Tabs --- */
        .tabs { 
            display: flex; gap: 15px; margin-bottom: 25px; 
            background: #e0e7ff; padding: 8px; border-radius: 20px;
        }
        .tab-btn {
            flex: 1; padding: 15px; border: none; border-radius: 16px;
            background: transparent; cursor: pointer; 
            font-family: 'Nunito', sans-serif;
            font-weight: 700; font-size: 1.1rem;
            color: var(--primary); opacity: 0.6;
            transition: 0.3s;
        }
        .tab-btn.active { 
            background: #ffffff; 
            color: var(--primary); 
            opacity: 1;
            box-shadow: 0 4px 10px rgba(3, 19, 131, 0.1);
        }

        .pane { display: none; animation: fadeIn 0.4s ease; }
        .pane.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Input Areas --- */
        .upload-box {
            border: 3px dashed #a5b4fc; padding: 40px; 
            border-radius: 20px; text-align: center; cursor: pointer; 
            background: #f8fafc; transition: 0.3s;
        }
        .upload-box:hover { background: #eef2ff; border-color: var(--primary); }
        .upload-icon { font-size: 3rem; margin-bottom: 10px; display: block; }

        textarea {
            width: 100%; height: 180px; padding: 20px;
            border-radius: 20px; border: 3px solid #e0e7ff;
            box-sizing: border-box; font-family: 'Nunito', sans-serif; 
            font-size: 1.1rem; color: var(--primary); font-weight: 600;
            background: #fdfdfd; resize: vertical;
        }
        textarea:focus { outline: none; border-color: var(--primary); }

        /* --- Game Buttons --- */
        .btn-3d {
            width: 100%; padding: 18px; 
            color: white; border: none; border-radius: 18px;
            font-family: 'Nunito', sans-serif; font-weight: 800; font-size: 1.3rem; 
            cursor: pointer; margin-top: 15px;
            transition: all 0.1s; position: relative;
            text-transform: uppercase; letter-spacing: 0.5px;
        }
        
        .btn-start {
            background: var(--primary);
            box-shadow: 0 6px 0 var(--primary-dark);
        }
        .btn-submit {
            background: var(--action);
            box-shadow: 0 6px 0 var(--action-dark);
        }

        .btn-3d:active {
            transform: translateY(6px);
            box-shadow: 0 0 0 transparent;
        }

        /* --- Quiz Cards --- */
        .quiz-area { display: none; margin-top: 40px; }
        .q-card {
            border: 3px solid #eef2ff; padding: 25px;
            border-radius: 24px; margin-bottom: 30px;
            background: #fff; position: relative;
        }

        .q-number {
            background: var(--accent); color: var(--primary);
            padding: 5px 12px; border-radius: 10px; font-weight: 800;
            display: inline-block; margin-bottom: 10px; font-size: 0.9rem;
        }

        .q-text { 
            font-size: 1.4rem; font-weight: 700; 
            color: var(--primary); margin-bottom: 20px; 
        }

        .options { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .opt {
            padding: 18px; border: 3px solid #eef2ff;
            border-radius: 16px; cursor: pointer;
            transition: 0.2s; font-weight: 700; font-size: 1.05rem;
            color: #4b5563; background: #fff;
        }
        .opt:hover { border-color: var(--accent); background: #fffbeb; transform: translateY(-2px); }
        .opt.selected { 
            background: var(--primary); color: white; 
            border-color: var(--primary); 
            box-shadow: 0 5px 15px rgba(3, 19, 131, 0.3);
        }

        /* --- Feedback Section --- */
        .feedback {
            margin-top: 20px; padding: 20px; border-radius: 18px;
            display: none; background: #f0fdf4; border: 2px solid var(--success);
            animation: popIn 0.3s ease-out;
        }
        @keyframes popIn { from { transform: scale(0.9); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        .ipa-line { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; }
        .ipa-text { 
            color: var(--action); font-weight: 700; 
            font-family: 'Courier New', monospace; font-size: 1.3rem; 
            background: #fff0f0; padding: 4px 10px; border-radius: 8px;
        }
        
        .speak-btn {
            background: var(--primary); color: white; border: none; border-radius: 50%;
            width: 45px; height: 45px; cursor: pointer;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.4rem; transition: 0.2s;
            box-shadow: 0 4px 0 var(--primary-dark);
        }
        .speak-btn:active { transform: translateY(4px); box-shadow: none; }

        /* --- Score Board --- */
        #scoreBox { 
            display: none; text-align: center; padding: 40px; 
            border-radius: 25px; background: var(--primary); 
            color: white; margin-bottom: 30px;
            box-shadow: 0 10px 20px rgba(3, 19, 131, 0.25);
            border: 4px solid var(--accent);
        }
        #scoreBox h2 { font-size: 2.5rem; margin: 0 0 10px 0; color: var(--accent); font-weight: 900; }
        #scoreBox p { font-size: 1.2rem; opacity: 0.9; font-weight: 600; }

        @media (max-width: 600px) { 
            .options { grid-template-columns: 1fr; } 
            .container { padding: 20px; }
            .header h1 { font-size: 2rem; }
        }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>Word Master üéÆ</h1>
        <p>Level up your vocabulary & Pronunciation</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('fileTab', this)">üìÅ Upload Docx</button>
        <button class="tab-btn" onclick="switchTab('textTab', this)">‚úçÔ∏è Paste List</button>
    </div>

    <div id="fileTab" class="pane active">
        <div class="upload-box" onclick="document.getElementById('fileIn').click()">
            <span class="upload-icon">üìÇ</span>
            <strong id="fileInfo" style="font-size: 1.2rem; color: var(--primary);">Tap to upload .docx file</strong>
            <p style="color: #889; margin-top:5px; font-size: 0.9rem;">Format: Word : Definition</p>
            <input type="file" id="fileIn" hidden accept=".docx">
        </div>
    </div>

    <div id="textTab" class="pane">
        <textarea id="rawInput" placeholder="Enter your list here. Example format:
1. Alleviate : l√†m nh·∫π b·ªõt
- Ambivalent : c√≥ c·∫£m x√∫c l·∫´n l·ªôn"></textarea>
        <button class="btn-3d btn-start" onclick="processText()">üöÄ Start The Game</button>
    </div>

    <div id="scoreBox"></div>

    <div id="quizArea" class="quiz-area">
        <div id="quizContent"></div>
        <button class="btn-3d btn-submit" onclick="checkAll()">üèÜ Submit & View Score</button>
    </div>
</div>

<script>
    // Demo Database
    const megaBank = [
    {w: "Alleviate", i: "/…ôÀàliÀêvie…™t/", m: "L√†m gi·∫£m b·ªõt m·ª©c ƒë·ªô nghi√™m tr·ªçng", e: "The new medicine helps to alleviate the symptoms of the flu."},
    {w: "Ambivalent", i: "/√¶mÀàb…™v…ôl…ônt/", m: "C√≥ c·∫£m gi√°c ƒëan xen, v·ª´a th√≠ch v·ª´a kh√¥ng", e: "He felt ambivalent about his new job; he loved the pay but hated the hours."},
    {w: "Anomaly", i: "/…ôÀàn…ím…ôli/", m: "ƒêi·ªÅu b·∫•t th∆∞·ªùng ho·∫∑c ngo·∫°i l·ªá", e: "The scientific results were an anomaly and didn't fit the pattern."},
    {w: "Articulate", i: "/…ëÀêÀàt…™kjule…™t/", m: "Di·ªÖn ƒë·∫°t √Ω t∆∞·ªüng r√µ r√†ng v√† l∆∞u lo√°t", e: "She is an articulate speaker who explains complex ideas clearly."},
    {w: "Assertive", i: "/…ôÀàs…úÀêt…™v/", m: "T·ª± tin v√† quy·∫øt ƒëo√°n trong vi·ªác b√†y t·ªè √Ω ki·∫øn", e: "Being assertive means standing up for what you believe in."},
    {w: "Autonomous", i: "/…îÀêÀàt…ín…ôm…ôs/", m: "T·ª± ch·ªß, ho·∫°t ƒë·ªông ƒë·ªôc l·∫≠p", e: "Teachers want their students to become more autonomous learners."},
    {w: "Benevolent", i: "/b…ôÀànev…ôl…ônt/", m: "T·ª≠ t·∫ø v√† hay gi√∫p ƒë·ª° ng∆∞·ªùi kh√°c", e: "A benevolent uncle paid for her college tuition."},
    {w: "Coherent", i: "/k…ô äÀàh…™…ôr…ônt/", m: "M·∫°ch l·∫°c, h·ª£p l√Ω v√† nh·∫•t qu√°n", e: "He was so drunk he wasn't making any coherent sense."},
    {w: "Complacent", i: "/k…ômÀàple…™snt/", m: "T·ª± m√£n, qu√° h√†i l√≤ng v·ªõi th√†nh t√≠ch", e: "We cannot afford to become complacent about our success."},
    {w: "Concede", i: "/k…ônÀàsiÀêd/", m: "Th·ª´a nh·∫≠n ƒëi·ªÅu g√¨ ƒë√≥ l√† ƒë√∫ng ho·∫∑c nh∆∞·ªùng b·ªô", e: "The government has finally conceded that its policies were wrong."},
    {w: "Conspicuous", i: "/k…ônÀàsp…™kju…ôs/", m: "D·ªÖ th·∫•y, n·ªïi b·∫≠t", e: "The bird has a conspicuous red head."},
    {w: "Corroborate", i: "/k…ôÀàr…íb…ôre…™t/", m: "X√°c nh·∫≠n, cung c·∫•p th√™m b·∫±ng ch·ª©ng h·ªó tr·ª£", e: "Recent research seems to corroborate his theory."},
    {w: "Cursory", i: "/Ààk…úÀês…ôri/", m: "Qua loa, nhanh ch√≥ng v√† kh√¥ng k·ªπ l∆∞·ª°ng", e: "He gave the report a cursory glance before the meeting."},
    {w: "Dearth", i: "/d…úÀêŒ∏/", m: "S·ª± thi·∫øu h·ª•t, khan hi·∫øm", e: "There is a dearth of reliable information on the subject."},
    {w: "Debilitate", i: "/d…™Ààb…™l…™te…™t/", m: "L√†m suy y·∫øu, l√†m ki·ªát s·ª©c", e: "The disease can debilitate the patient for many weeks."},
    {w: "Deference", i: "/Ààdef…ôr…ôns/", m: "Th√°i ƒë·ªô t√¥n tr·ªçng v√† l·ªÖ ph√©p", e: "He treats her with great deference because of her age."},
    {w: "Deleterious", i: "/Àådel…™Ààt…™…ôri…ôs/", m: "C√≥ h·∫°i cho s·ª©c kh·ªèe ho·∫∑c h·∫°nh ph√∫c", e: "Smoking has a deleterious effect on your health."},
    {w: "Delineate", i: "/d…™Ààl…™nie…™t/", m: "M√¥ t·∫£ ho·∫∑c ph√°c th·∫£o m·ªôt c√°ch ch√≠nh x√°c", e: "The report clearly delineates the steps that must be taken."},
    {w: "Denounce", i: "/d…™Ààna äns/", m: "L√™n √°n, ch·ªâ tr√≠ch c√¥ng khai", e: "The dictator's actions were denounced by world leaders."},
    {w: "Deplore", i: "/d…™Ààpl…îÀê(r)/", m: "L√™n √°n, ph·∫£n ƒë·ªëi k·ªãch li·ªát", e: "We deplore all forms of violence."},
    {w: "Detached", i: "/d…™Ààt√¶t Ét/", m: "T√°ch bi·ªát, kh√¥ng ƒë·ªÉ c·∫£m x√∫c c√° nh√¢n ·∫£nh h∆∞·ªüng", e: "He tries to remain detached from the office politics."},
    {w: "Deterrent", i: "/d…™Ààter…ônt/", m: "Y·∫øu t·ªë ngƒÉn c·∫£n, l√†m n·∫£n l√≤ng", e: "Tougher prison sentences may act as a deterrent to crime."},
    {w: "Deviate", i: "/ÀàdiÀêvie…™t/", m: "ƒêi ch·ªách h∆∞·ªõng, kh√¥ng tu√¢n theo", e: "Never deviate from the original plan."},
    {w: "Didactic", i: "/da…™Ààd√¶kt…™k/", m: "Mang t√≠nh gi√°o hu·∫•n, c√≥ m·ª•c ƒë√≠ch d·∫°y b·∫£o", e: "The story is didactic, intended to teach a moral lesson."},
    {w: "Diligent", i: "/Ààd…™l…™d í…ônt/", m: "ChƒÉm ch·ªâ, c·∫ßn m·∫´n", e: "He is a diligent worker who never misses a deadline."},
    {w: "Discrepancy", i: "/d…™Ààskrep…ônsi/", m: "S·ª± kh√°c bi·ªát, m√¢u thu·∫´n gi·ªØa c√°c s·ª± ki·ªán", e: "There is a discrepancy between the two witnesses' accounts."},
    {w: "Eclectic", i: "/…™Ààklekt…™k/", m: "ƒê∆∞·ª£c l·ª±a ch·ªçn t·ª´ nhi·ªÅu ngu·ªìn kh√°c nhau", e: "She has an eclectic taste in music, from classical to hip-hop."},
    {w: "Eloquent", i: "/Ààel…ôkw…ônt/", m: "H√πng h·ªìn, di·ªÖn ƒë·∫°t l∆∞u lo√°t v√† thuy·∫øt ph·ª•c", e: "Her eloquent speech moved the entire audience."},
    {w: "Empathy", i: "/Ààemp…ôŒ∏i/", m: "Kh·∫£ nƒÉng th·∫•u hi·ªÉu v√† chia s·∫ª c·∫£m x√∫c v·ªõi ng∆∞·ªùi kh√°c", e: "A good doctor needs to have empathy for her patients."},
    {w: "Empirical", i: "/…™mÀàp…™r…™kl/", m: "D·ª±a tr√™n quan s√°t ho·∫∑c th√≠ nghi·ªám th·ª±c t·∫ø", e: "They gathered empirical evidence to support their hypothesis."},
    {w: "Enhance", i: "/…™nÀàh…ëÀêns/", m: "N√¢ng cao, c·∫£i thi·ªán ch·∫•t l∆∞·ª£ng ho·∫∑c gi√° tr·ªã", e: "The spices enhanced the flavor of the dish."},
    {w: "Ephemeral", i: "/…™Ààfem…ôr…ôl/", m: "Ng·∫Øn ng·ªßi, ch·ªâ t·ªìn t·∫°i trong th·ªùi gian ng·∫Øn", e: "The ephemeral beauty of cherry blossoms attracts many tourists."},
    {w: "Equivocal", i: "/…™Ààkw…™v…ôkl/", m: "M∆° h·ªì, kh√¥ng r√µ r√†ng v√† c√≥ th·ªÉ hi·ªÉu theo nhi·ªÅu c√°ch", e: "His equivocal answer left everyone confused."},
    {w: "Erratic", i: "/…™Ààr√¶t…™k/", m: "Th·∫•t th∆∞·ªùng, kh√¥ng ·ªïn ƒë·ªãnh v√† kh√≥ d·ª± ƒëo√°n", e: "The stock market has been erratic this week."},
    {w: "Exacerbate", i: "/…™…°Ààz√¶s…ôbe…™t/", m: "L√†m tr·∫ßm tr·ªçng th√™m, l√†m t·ªá h∆°n", e: "His comments only exacerbated the conflict."},
    {w: "Exemplary", i: "/…™…°Ààzempl…ôri/", m: "Ki·ªÉu m·∫´u, xu·∫•t s·∫Øc v√† ƒë√°ng ƒë∆∞·ª£c noi theo", e: "Her exemplary conduct earned her a promotion."},
    {w: "Exhaustive", i: "/…™…°Ààz…îÀêst…™v/", m: "To√†n di·ªán, bao qu√°t m·ªçi kh√≠a c·∫°nh", e: "They conducted an exhaustive investigation into the matter."},
    {w: "Explicit", i: "/…™kÀàspl…™s…™t/", m: "ƒê∆∞·ª£c n√≥i r√µ r√†ng, chi ti·∫øt, kh√¥ng che gi·∫•u", e: "The contract contains explicit instructions about data use."},
    {w: "Facilitate", i: "/f…ôÀàs…™l…™te…™t/", m: "T·∫°o ƒëi·ªÅu ki·ªán thu·∫≠n l·ª£i, l√†m cho d·ªÖ d√†ng h∆°n", e: "The new software facilitates online collaboration."},
    {w: "Fallacious", i: "/f…ôÀàle…™ É…ôs/", m: "Sai l·∫ßm, d·ª±a tr√™n m·ªôt ni·ªÅm tin kh√¥ng ƒë√∫ng s·ª± th·∫≠t", e: "His argument was based on fallacious reasoning."},
    {w: "Frugal", i: "/ÀàfruÀê…°l/", m: "Ti·∫øt ki·ªám, √≠t ti√™u x√†i", e: "Despite being wealthy, he leads a frugal lifestyle."},
    {w: "Futile", i: "/ÀàfjuÀêta…™l/", m: "V√¥ √≠ch, kh√¥ng c√≥ c∆° h·ªôi th√†nh c√¥ng", e: "It is futile to resist the new regulations."},
    {w: "Garrulous", i: "/Àà…°√¶r…ôl…ôs/", m: "Ba hoa, n√≥i nhi·ªÅu v·ªÅ nh·ªØng chuy·ªán kh√¥ng quan tr·ªçng", e: "The garrulous taxi driver talked non-stop throughout the ride."},
    {w: "Gregarious", i: "/…°r…™Àà…°e…ôri…ôs/", m: "H√≤a ƒë·ªìng, th√≠ch giao du", e: "She's very gregarious and loves hosting parties."},
    {w: "Hapless", i: "/Ààh√¶pl…ôs/", m: "B·∫•t h·∫°nh, kh√¥ng may m·∫Øn", e: "The hapless tourists lost their passports on the first day."},
    {w: "Harangue", i: "/h…ôÀàr√¶≈ã/", m: "B√†i di·ªÖn thuy·∫øt d√†i, gay g·∫Øt, mang t√≠nh ch·∫•t c√¥ng k√≠ch", e: "The manager delivered a long harangue about punctuality."},
    {w: "Hedonist", i: "/ÀàhiÀêd…ôn…™st/", m: "Ng∆∞·ªùi theo ch·ªß nghƒ©a kho√°i l·∫°c, t√¨m ki·∫øm ni·ªÅm vui", e: "As a hedonist, his only goal in life is pleasure."},
    {w: "Hierarchy", i: "/Ààha…™…ôr…ëÀêki/", m: "H·ªá th·ªëng ph√¢n c·∫•p, th·ª© b·∫≠c", e: "The company has a strict hierarchy."},
    {w: "Hypothetical", i: "/Àåha…™p…ôÀàŒ∏et…™kl/", m: "Gi·∫£ ƒë·ªãnh, mang t√≠nh ch·∫•t gi·∫£ thuy·∫øt", e: "Let's consider a hypothetical situation for this debate."},
    {w: "Idealistic", i: "/Àåa…™d…™…ôÀàl…™st…™k/", m: "L√Ω t∆∞·ªüng h√≥a, c√≥ ni·ªÅm tin v√†o nh·ªØng ti√™u chu·∫©n ho√†n h·∫£o", e: "His idealistic views were challenged by harsh reality."},
    {w: "Idiosyncratic", i: "/Àå…™di…ôs…™≈ãÀàkr√¶t…™k/", m: "C√≥ ƒë·∫∑c ƒëi·ªÉm ho·∫∑c th√≥i quen ri√™ng bi·ªát, kh√°c th∆∞·ªùng", e: "She has an idiosyncratic way of dressing."},
    {w: "Impetuous", i: "/…™mÀàpet Éu…ôs/", m: "H·∫•p t·∫•p, h√†nh ƒë·ªông thi·∫øu suy nghƒ©", e: "His impetuous decision led to financial loss."},
    {w: "Incessant", i: "/…™nÀàsesnt/", m: "Kh√¥ng ng·ª´ng, li√™n t·ª•c (th∆∞·ªùng theo nghƒ©a ti√™u c·ª±c)", e: "The incessant noise from the construction site was unbearable."},
    {w: "Inconsequential", i: "/…™nÀåk…íns…™Ààkwen Él/", m: "Kh√¥ng quan tr·ªçng, kh√¥ng ƒë√°ng k·ªÉ", e: "The details are inconsequential to the main argument."},
    {w: "Inevitable", i: "/…™nÀàev…™t…ôbl/", m: "Ch·∫Øc ch·∫Øn x·∫£y ra, kh√¥ng th·ªÉ tr√°nh kh·ªèi", e: "Conflict between them seemed inevitable."},
    {w: "Innate", i: "/…™Ààne…™t/", m: "B·∫©m sinh, c√≥ t·ª´ khi sinh ra", e: "She has an innate talent for music."},
    {w: "Innovative", i: "/Àà…™n…ôve…™t…™v/", m: "ƒê·ªïi m·ªõi, s√°ng t·∫°o", e: "The company is known for its innovative products."},
    {w: "Insatiable", i: "/…™nÀàse…™ É…ôbl/", m: "Kh√¥ng th·ªÉ th·ªèa m√£n, kh√¥ng bao gi·ªù ƒë·ªß", e: "He has an insatiable curiosity about the universe."},
    {w: "Integrity", i: "/…™nÀàte…°r…ôti/", m: "S·ª± ch√≠nh tr·ª±c, nguy√™n t·∫Øc ƒë·∫°o ƒë·ª©c m·∫°nh m·∫Ω", e: "She is a person of great integrity and honesty."},
    {w: "Juxtaposition", i: "/Àåd í åkst…ôp…ôÀàz…™ Én/", m: "S·ª± ƒë·∫∑t c·∫°nh nhau ƒë·ªÉ so s√°nh ho·∫∑c t∆∞∆°ng ph·∫£n", e: "The juxtaposition of old and new architecture is striking."},
    {w: "Laconic", i: "/l…ôÀàk…ín…™k/", m: "Ng·∫Øn g·ªçn, s√∫c t√≠ch, d√πng r·∫•t √≠t l·ªùi", e: "He gave a laconic reply: 'No.'"},
    {w: "Lament", i: "/l…ôÀàment/", m: "Than th·ªü, th·ªÉ hi·ªán n·ªói bu·ªìn ho·∫∑c h·ªëi ti·∫øc", e: "The poem laments the loss of a golden age."},
    {w: "Laudable", i: "/Ààl…îÀêd…ôbl/", m: "ƒê√°ng khen ng·ª£i, ca ng·ª£i", e: "Her efforts to help the homeless are laudable."},
    {w: "Lethargic", i: "/l…ôÀàŒ∏…ëÀêd í…™k/", m: "U·ªÉ o·∫£i, thi·∫øu nƒÉng l∆∞·ª£ng", e: "The hot weather made everyone feel lethargic."},
    {w: "Magnanimous", i: "/m√¶…°Ààn√¶n…™m…ôs/", m: "R·ªông l∆∞·ª£ng, cao th∆∞·ª£ng", e: "The magnanimous winner praised his opponent."},
    {w: "Meticulous", i: "/m…ôÀàt…™kj…ôl…ôs/", m: "T·ªâ m·ªâ, c·∫©n th·∫≠n ƒë·∫øn t·ª´ng chi ti·∫øt", e: "She is meticulous about planning every event."},
    {w: "Mitigate", i: "/Ààm…™t…™…°e…™t/", m: "L√†m gi·∫£m nh·∫π m·ª©c ƒë·ªô nghi√™m tr·ªçng", e: "Planting trees can help mitigate climate change."},
    {w: "Novel", i: "/Ààn…ívl/", m: "M·ªõi l·∫°, kh√°c th∆∞·ªùng", e: "He proposed a novel approach to the problem."},
    {w: "Oblivious", i: "/…ôÀàbl…™vi…ôs/", m: "Kh√¥ng √Ω th·ª©c ƒë∆∞·ª£c, kh√¥ng ƒë·ªÉ √Ω t·ªõi", e: "He was oblivious to the fact that everyone was staring at him."},
    {w: "Obsolete", i: "/Àà…íbs…ôliÀêt/", m: "L·ªói th·ªùi, kh√¥ng c√≤n ƒë∆∞·ª£c s·ª≠ d·ª•ng", e: "Floppy disks are now obsolete technology."},
    {w: "Ostensible", i: "/…íÀàstens…ôbl/", m: "B·ªÅ ngo√†i, ƒë∆∞·ª£c ƒë∆∞a ra l√†m l√Ω do ch√≠nh th·ª©c nh∆∞ng c√≥ th·ªÉ kh√¥ng ph·∫£i th·∫≠t", e: "His ostensible reason for visiting was to discuss business."},
    {w: "Paradigm", i: "/Ààp√¶r…ôda…™m/", m: "M√¥ h√¨nh, khu√¥n m·∫´u ƒë·ªÉ suy nghƒ©", e: "This discovery caused a paradigm shift in physics."},
    {w: "Paramount", i: "/Ààp√¶r…ôma änt/", m: "T·ªëi quan tr·ªçng, tr√™n h·∫øt", e: "Safety is of paramount importance in this factory."},
    {w: "Pragmatic", i: "/pr√¶…°Ààm√¶t…™k/", m: "Th·ª±c t·∫ø, t·∫≠p trung v√†o k·∫øt qu·∫£ h∆°n l√† l√Ω thuy·∫øt", e: "She took a pragmatic approach to solving the crisis."},
    {w: "Precarious", i: "/pr…™Ààke…ôri…ôs/", m: "B·∫•p b√™nh, kh√¥ng ·ªïn ƒë·ªãnh v√† nguy hi·ªÉm", e: "He was in a precarious financial situation."},
    {w: "Proficient", i: "/pr…ôÀàf…™ Ént/", m: "Th√†nh th·∫°o, c√≥ k·ªπ nƒÉng cao", e: "She is proficient in three languages."},
    {w: "Prolific", i: "/pr…ôÀàl…™f…™k/", m: "S·∫£n xu·∫•t nhi·ªÅu (t√°c ph·∫©m, √Ω t∆∞·ªüng)", e: "He was a prolific writer, publishing over 50 novels."},
    {w: "Prudent", i: "/ÀàpruÀêdnt/", m: "Th·∫≠n tr·ªçng, kh√¥n ngoan, bi·∫øt nh√¨n xa", e: "It would be prudent to save some money for emergencies."},
    {w: "Quintessential", i: "/Àåkw…™nt…™Ààsen Él/", m: "ƒêi·ªÉn h√¨nh nh·∫•t, thu·∫ßn t√∫y nh·∫•t c·ªßa c√°i g√¨", e: "He is the quintessential English gentleman."},
    {w: "Radical", i: "/Ààr√¶d…™kl/", m: "Tri·ªát ƒë·ªÉ, c∆° b·∫£n; ng∆∞·ªùi theo ch·ªß nghƒ©a c·∫•p ti·∫øn", e: "The company needs radical changes to survive."},
    {w: "Revere", i: "/r…™Ààv…™…ô(r)/", m: "T√¥n k√≠nh, ng∆∞·ª°ng m·ªô s√¢u s·∫Øc", e: "He is revered as a national hero."},
    {w: "Rhetoric", i: "/Ààret…ôr…™k/", m: "Ngh·ªá thu·∫≠t h√πng bi·ªán; l·ªùi n√≥i c√≥ t√≠nh ch·∫•t ph√¥ tr∆∞∆°ng", e: "His speech was full of empty political rhetoric."},
    {w: "Scrutinize", i: "/ÀàskruÀêt…ôna…™z/", m: "Xem x√©t k·ªπ l∆∞·ª°ng, nghi√™n c·ª©u t·ªâ m·ªâ", e: "The committee will scrutinize every detail of the proposal."},
    {w: "Spontaneous", i: "/sp…ínÀàte…™ni…ôs/", m: "T·ª± ph√°t, kh√¥ng c√≥ k·∫ø ho·∫°ch tr∆∞·ªõc", e: "We made a spontaneous decision to go to the beach."},
    {w: "Substantiate", i: "/s…ôbÀàst√¶n Éie…™t/", m: "Cung c·∫•p b·∫±ng ch·ª©ng ch·ª©ng minh", e: "Can you substantiate your claim with any data?"},
    {w: "Subtle", i: "/Ààs åtl/", m: "Tinh t·∫ø, kh√≥ nh·∫≠n th·∫•y", e: "There is a subtle difference between these two shades of blue."},
    {w: "Superficial", i: "/ÀåsuÀêp…ôÀàf…™ Él/", m: "H·ªùi h·ª£t, ch·ªâ tr√™n b·ªÅ m·∫∑t; kh√¥ng s√¢u s·∫Øc", e: "She has only a superficial knowledge of the subject."},
    {w: "Tangible", i: "/Ààt√¶nd í…ôbl/", m: "H·ªØu h√¨nh, c√≥ th·ªÉ ch·∫°m v√†o; r√µ r√†ng", e: "We need tangible results, not just promises."},
    {w: "Tenacious", i: "/t…ôÀàne…™ É…ôs/", m: "Ki√™n ƒë·ªãnh, b√°m gi·ªØ ch·∫∑t ch·∫Ω", e: "She is a tenacious competitor who never gives up."},
    {w: "Transient", i: "/Ààtr√¶nzi…ônt/", m: "T·∫°m th·ªùi, tho√°ng qua", e: "His happiness was only transient."},
    {w: "Ubiquitous", i: "/juÀêÀàb…™kw…™t…ôs/", m: "C√≥ m·∫∑t ·ªü kh·∫Øp m·ªçi n∆°i", e: "Mobile phones are now ubiquitous."},
    {w: "Unprecedented", i: "/ ånÀàpres…™dent…™d/", m: "Ch∆∞a t·ª´ng c√≥ ti·ªÅn l·ªá", e: "The pandemic caused an unprecedented global crisis."},
    {w: "Validate", i: "/Ààv√¶l…™de…™t/", m: "X√°c nh·∫≠n, ch·ª©ng th·ª±c l√† ƒë√∫ng", e: "This experiment validates our original theory."},
    {w: "Vehement", i: "/ÀàviÀê…ôm…ônt/", m: "M√£nh li·ªát, ƒë·∫ßy c·∫£m x√∫c m·∫°nh m·∫Ω", e: "She was vehement in her denial of the accusations."},
    {w: "Viable", i: "/Ààva…™…ôbl/", m: "Kh·∫£ thi, c√≥ th·ªÉ th√†nh c√¥ng", e: "Solar power is a viable alternative energy source."},
    {w: "Vindicate", i: "/Ààv…™nd…™ke…™t/", m: "Ch·ª©ng minh l√† ƒë√∫ng, minh oan", e: "The new evidence completely vindicated him."},
    {w: "Volatile", i: "/Ààv…íl…ôta…™l/", m: "D·ªÖ thay ƒë·ªïi, kh√¥ng ·ªïn ƒë·ªãnh; d·ªÖ bay h∆°i", e: "The political situation in the region is highly volatile."},
    {w: "Wary", i: "/Ààwe…ôri/", m: "Th·∫≠n tr·ªçng, c·∫£nh gi√°c", e: "Be wary of strangers offering you money."},
    {w: "Whimsical", i: "/Ààw…™mz…™kl/", m: "ƒê·ªèng ƒë·∫£nh, k·ª≥ l·∫° m·ªôt c√°ch vui v·∫ª", e: "She has a whimsical sense of humor."},
    {w: "Zealous", i: "/Ààzel…ôs/", m: "HƒÉng h√°i, nhi·ªát th√†nh", e: "He is a zealous supporter of environmental causes."}
];

    const synth = window.speechSynthesis;
    let userVocab = [];

    // --- HELPER FUNCTIONS ---
    function isMobile() {
        return /Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
    }

    function capitalize(str) {
        if (!str) return "";
        str = str.trim();
        return str.charAt(0).toUpperCase() + str.slice(1);
    }

    function cleanPrefix(str) {
        return str.replace(/^[\s\d.\-\*)\>]+/, "").trim();
    }

    // --- AUDIO LOGIC (HYBRID) ---
    function speak(text) {
        synth.cancel();
        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = 'en-US';

        if (isMobile()) {
            setTimeout(() => {
                const voices = synth.getVoices();
                const bestVoice = voices.find(v => v.name.includes('Google') && v.lang.includes('en-US')) ||
                                 voices.find(v => v.name.includes('Siri') && v.lang.includes('en-US')) ||
                                 voices.find(v => v.lang.includes('en-US'));
                if(bestVoice) msg.voice = bestVoice;
                msg.rate = 0.85;
                synth.speak(msg);
            }, 50);
        } else {
            msg.rate = 0.8;
            synth.speak(msg);
        }
    }

    function unlockAudio() {
        if (isMobile()) {
            const ut = new SpeechSynthesisUtterance(' ');
            ut.volume = 0;
            synth.speak(ut);
        }
    }

    // --- CORE LOGIC ---
    function parseLines(text) {
        userVocab = [];
        text.split('\n').forEach(line => {
            if(line.includes(':')) {
                const parts = line.split(':');
                let rawWord = cleanPrefix(parts[0]);
                let rawMeaning = parts[1].trim();

                if (rawWord && rawMeaning) {
                    userVocab.push({
                        w: capitalize(rawWord),
                        m: capitalize(rawMeaning),
                        e: "Practice makes perfect!" // Default example for custom uploads
                    });
                }
            }
        });
        if(userVocab.length > 0) {
            unlockAudio();
            generateQuiz();
        } else {
            alert("Could not find any vocabulary. Ensure format is 'Word : Definition'");
        }
    }

    function processText() {
        const val = document.getElementById('rawInput').value;
        if(!val) return alert("Please paste your vocabulary list first!");
        parseLines(val);
    }

    document.getElementById('fileIn').addEventListener('change', function(e) {
        const file = e.target.files[0];
        if(!file) return;
        document.getElementById('fileInfo').innerText = "Loaded: " + file.name;
        document.getElementById('fileInfo').style.color = "var(--success)";
        const reader = new FileReader();
        reader.onload = (ev) => {
            mammoth.extractRawText({ arrayBuffer: ev.target.result }).then(res => parseLines(res.value));
        };
        reader.readAsArrayBuffer(file);
    });

    function generateQuiz() {
        const container = document.getElementById('quizContent');
        container.innerHTML = '';
        document.getElementById('scoreBox').style.display = 'none';
        document.getElementById('quizArea').style.display = 'block';

        let pool = [...userVocab];
        // Fill up to 20 questions from MegaBank if user list is short
        if(pool.length < 20) {
            let shuffledBank = [...megaBank].sort(() => 0.5 - Math.random());
            for(let item of shuffledBank) {
                if(pool.length >= 20) break;
                if(!pool.some(x => x.w.toLowerCase() === item.w.toLowerCase())) {
                    pool.push(item);
                }
            }
        }
        
        let quiz20 = pool.sort(() => 0.5 - Math.random()).slice(0, 20);

        quiz20.forEach((item, idx) => {
            const isEngQ = Math.random() > 0.5;
            const qTxt = isEngQ ? `What is the meaning of "<span style='text-decoration:underline; text-decoration-color:var(--accent)'>${item.w}</span>"?` : `Which word means: "${item.m}"?`;
            const correctAns = isEngQ ? item.m : item.w;
            
            let others = quiz20.filter(x => x.w !== item.w).map(x => isEngQ ? x.m : x.w);
            let opts = [correctAns, ...others.sort(() => 0.5 - Math.random()).slice(0, 3)].sort(() => 0.5 - Math.random());

            container.innerHTML += `
                <div class="q-card" data-correct="${correctAns}">
                    <span class="q-number">Question ${idx+1}</span>
                    <div class="q-text">${qTxt}</div>
                    <div class="options">
                        ${opts.map(o => `<div class="opt" onclick="selectOpt(this)">${o}</div>`).join('')}
                    </div>
                    <div class="feedback">
                        <div class="ipa-line">
                            <span class="ipa-text">${item.w}</span>
                            <button class="speak-btn" title="Listen" onclick="speak('${item.w}')">üîä</button>
                        </div>
                        <p><strong>Example:</strong> ${item.e}</p>
                    </div>
                </div>
            `;
        });
        window.scrollTo({ top: document.getElementById('quizArea').offsetTop, behavior: 'smooth' });
    }

    function selectOpt(el) {
        el.parentElement.querySelectorAll('.opt').forEach(o => o.classList.remove('selected'));
        el.classList.add('selected');
    }

    function checkAll() {
        const cards = document.querySelectorAll('.q-card');
        let score = 0;
        cards.forEach(card => {
            const sel = card.querySelector('.opt.selected');
            const cor = card.getAttribute('data-correct');
            const fb = card.querySelector('.feedback');
            
            fb.style.display = 'block';

            if(sel && sel.innerText === cor) {
                score++;
                fb.style.borderColor = "var(--success)";
                fb.style.background = "#f0fdf4";
                // Add a checkmark visual
                if(!sel.innerHTML.includes('‚úÖ')) sel.innerHTML += ' ‚úÖ';
                sel.style.backgroundColor = "var(--success)";
                sel.style.borderColor = "var(--success)";
            } else {
                fb.style.borderColor = "var(--danger)";
                fb.style.background = "#fff1f2";
                fb.innerHTML = `<div style="color:var(--danger); font-weight:bold; margin-bottom:8px;">‚ùå Oops! Correct answer: ${cor}</div>` + fb.innerHTML;
                
                // Highlight the user's wrong choice
                if(sel) {
                    sel.style.backgroundColor = "var(--danger)";
                    sel.style.borderColor = "var(--danger)";
                    sel.style.color = "white";
                }
            }
        });

        const box = document.getElementById('scoreBox');
        box.style.display = 'block';
        
        let msg = "Keep Practicing! üí™";
        if(score > 15) msg = "Excellent Job! üåü";
        if(score === 20) msg = "Perfect Score! üëë";

        box.innerHTML = `<h2>${score}/20</h2><p>${msg}</p><p style="margin-top:10px; font-size:1rem">Tap üîä on the cards below to review pronunciation.</p>`;
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function switchTab(id, btn) {
        document.querySelectorAll('.pane').forEach(p => p.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        btn.classList.add('active');
    }
</script>

</body>
</html>
